[{"id":"7312764088","type":"PushEvent","actor":{"id":21217,"login":"cjb","display_login":"cjb","gravatar_id":"","url":"https://api.github.com/users/cjb","avatar_url":"https://avatars.githubusercontent.com/u/21217?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366792463,"size":1,"distinct_size":1,"ref":"refs/heads/cjb/DESKTOP-6170-chat-from-team-page","head":"7aac0e5ac18cdfa70a191e329105ffe3327d2bb9","before":"dcdd0d1a276054d523c487ad541a632611e883e1","commits":[{"sha":"7aac0e5ac18cdfa70a191e329105ffe3327d2bb9","author":{"email":"chris@printf.net","name":"Chris Ball"},"message":"Show a Chat icon on team page member rows, desktop and mobile","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/7aac0e5ac18cdfa70a191e329105ffe3327d2bb9"}]},"public":true,"created_at":"2018-02-28T22:05:59Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312761500","type":"CreateEvent","actor":{"id":21217,"login":"cjb","display_login":"cjb","gravatar_id":"","url":"https://api.github.com/users/cjb","avatar_url":"https://avatars.githubusercontent.com/u/21217?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"ref":"cjb/DESKTOP-6170-chat-from-team-page","ref_type":"branch","master_branch":"master","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","pusher_type":"user"},"public":true,"created_at":"2018-02-28T22:05:26Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312730778","type":"CreateEvent","actor":{"id":1250314,"login":"mmaxim","display_login":"mmaxim","gravatar_id":"","url":"https://api.github.com/users/mmaxim","avatar_url":"https://avatars.githubusercontent.com/u/1250314?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"ref":"mike/CORE-7288","ref_type":"branch","master_branch":"master","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","pusher_type":"user"},"public":true,"created_at":"2018-02-28T21:59:16Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312720401","type":"PushEvent","actor":{"id":11968340,"login":"buoyad","display_login":"buoyad","gravatar_id":"","url":"https://api.github.com/users/buoyad","avatar_url":"https://avatars.githubusercontent.com/u/11968340?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366770014,"size":7,"distinct_size":2,"ref":"refs/heads/danny/DESKTOP-6158/center-role-picker","head":"da739bdca2e2f5e32bd7e7422a83e658ad4f82e6","before":"d05341d5db8c3013f116a592e101ea8be9482fcc","commits":[{"sha":"9bbb96a6e466c8de6594e2d9929c15ff2dd3fc24","author":{"email":"mike.maxim@gmail.com","name":"Mike Maxim"},"message":"skip TestTeamResetBadgesOnRemove","distinct":false,"url":"https://api.github.com/repos/keybase/client/commits/9bbb96a6e466c8de6594e2d9929c15ff2dd3fc24"},{"sha":"806eb4e6842af4041b24523be3a2e7148f9320f7","author":{"email":"mike.maxim@gmail.com","name":"Mike Maxim"},"message":"skip TestSubteamChats","distinct":false,"url":"https://api.github.com/repos/keybase/client/commits/806eb4e6842af4041b24523be3a2e7148f9320f7"},{"sha":"f6357528cdae87cb9cb91e9a253011e594035f1e","author":{"email":"akalin@keyba.se","name":"Fred Akalin"},"message":"Put trace button behind a secret handshake (#10705)\n\nOne would have to click the developer warning 7 times (a la Android)\r\nto show the trace button.\r\n\r\nIdeally, we'd know whether we're an admin build or not, and just use that,\r\nbut that's currently not easy, so going with this for now. This should deter\r\ncasual users.","distinct":false,"url":"https://api.github.com/repos/keybase/client/commits/f6357528cdae87cb9cb91e9a253011e594035f1e"},{"sha":"c88f6f7e0a0780839f3010f61192856853f208cd","author":{"email":"danny.a95@gmail.com","name":"Daniel Ayoub"},"message":"Add optional comments to action creators (#10707)\n\n* pipe _description through to action creator comment\r\n\r\n* factor out reserved keys","distinct":false,"url":"https://api.github.com/repos/keybase/client/commits/c88f6f7e0a0780839f3010f61192856853f208cd"},{"sha":"9613c18a266088c2e3af95f7529090ab71d4c432","author":{"email":"danny.a95@gmail.com","name":"Daniel Ayoub"},"message":"Make entire teams page scrollable (#10680)\n\n* initial refactor\r\n\r\n* WIP\r\n\r\n* WIP\r\n\r\n* factor out team header\r\n\r\n* clean up teams page\r\n\r\n* WIP\r\n\r\n* WIP\r\n\r\n* subteams work\r\n\r\n* initial item size estimator\r\n\r\n* gather subteam and member row types\r\n\r\n* initial sectionList on mobile\r\n\r\n* fix key problems\r\n\r\n* minor cleanup\r\n\r\n* requests and invites work\r\n\r\n* settings works on mobile\r\n\r\n* styling on desktop & mobile\r\n\r\n* type\r\n\r\n* WIP chat button\r\n\r\n* bail on chat button\r\n\r\n* better type\r\n\r\n* row key\r\n\r\n* bugfix\r\n\r\n* reenable chat button\r\n\r\n* better popup menu\r\n\r\n* disable chat button for upcoming release\r\n\r\n* chat button works","distinct":false,"url":"https://api.github.com/repos/keybase/client/commits/9613c18a266088c2e3af95f7529090ab71d4c432"},{"sha":"d9971163cce43a45a452ef04ada19ec3123736d8","author":{"email":"danny.a95@gmail.com","name":"Daniel Ayoub"},"message":"Merge branch 'master' into danny/DESKTOP-6158/center-role-picker","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/d9971163cce43a45a452ef04ada19ec3123736d8"},{"sha":"da739bdca2e2f5e32bd7e7422a83e658ad4f82e6","author":{"email":"danny.a95@gmail.com","name":"Daniel Ayoub"},"message":"storyshots","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/da739bdca2e2f5e32bd7e7422a83e658ad4f82e6"}]},"public":true,"created_at":"2018-02-28T21:57:06Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312711052","type":"PullRequestReviewCommentEvent","actor":{"id":866815,"login":"maxtaco","display_login":"maxtaco","gravatar_id":"","url":"https://api.github.com/users/maxtaco","avatar_url":"https://avatars.githubusercontent.com/u/866815?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/client/pulls/comments/171398034","pull_request_review_id":100244299,"id":171398034,"diff_hunk":"@@ -127,27 +136,61 @@ func (v *CmdConfigInfo) ParseArgv(ctx *cli.Context) error {\n }\n \n func (v *CmdConfigGet) Run() error {\n-\tcli, err := GetConfigClient(v.G())\n-\tif err != nil {\n-\t\treturn err\n-\t}\n-\tvar val keybase1.ConfigValue\n-\tval, err = cli.GetValue(context.TODO(), v.Path)\n-\tif err != nil {\n-\t\treturn err\n-\t}\n \tdui := v.G().UI.GetDumbOutputUI()\n-\tswitch {\n-\tcase val.IsNull:\n-\t\tdui.Printf(\"null\\n\")\n-\tcase val.I != nil:\n-\t\tdui.Printf(\"%d\\n\", *val.I)\n-\tcase val.S != nil:\n-\t\tdui.Printf(\"%q\\n\", *val.S)\n-\tcase val.B != nil:\n-\t\tdui.Printf(\"%t\\n\", *val.B)\n-\tcase val.O != nil:\n-\t\tdui.Printf(\"%s\\n\", *val.O)\n+\tif v.Direct {","path":"go/client/cmd_config.go","position":57,"original_position":57,"commit_id":"4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b","original_commit_id":"4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b","user":{"login":"maxtaco","id":866815,"avatar_url":"https://avatars0.githubusercontent.com/u/866815?v=4","gravatar_id":"","url":"https://api.github.com/users/maxtaco","html_url":"https://github.com/maxtaco","followers_url":"https://api.github.com/users/maxtaco/followers","following_url":"https://api.github.com/users/maxtaco/following{/other_user}","gists_url":"https://api.github.com/users/maxtaco/gists{/gist_id}","starred_url":"https://api.github.com/users/maxtaco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxtaco/subscriptions","organizations_url":"https://api.github.com/users/maxtaco/orgs","repos_url":"https://api.github.com/users/maxtaco/repos","events_url":"https://api.github.com/users/maxtaco/events{/privacy}","received_events_url":"https://api.github.com/users/maxtaco/received_events","type":"User","site_admin":false},"body":"can you split this up into 2 different functions?","created_at":"2018-02-28T21:55:12Z","updated_at":"2018-02-28T21:55:12Z","html_url":"https://github.com/keybase/client/pull/10724#discussion_r171398034","pull_request_url":"https://api.github.com/repos/keybase/client/pulls/10724","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/comments/171398034"},"html":{"href":"https://github.com/keybase/client/pull/10724#discussion_r171398034"},"pull_request":{"href":"https://api.github.com/repos/keybase/client/pulls/10724"}}},"pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10724","id":171863574,"html_url":"https://github.com/keybase/client/pull/10724","diff_url":"https://github.com/keybase/client/pull/10724.diff","patch_url":"https://github.com/keybase/client/pull/10724.patch","issue_url":"https://api.github.com/repos/keybase/client/issues/10724","number":10724,"state":"open","locked":false,"title":"packaging: allow a global config.json file that can turn off the root redirector","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"Once we turn on the root redirector, we'll probably face some detractors who don't like us using a mountpoint in /.  I think it makes sense to give them a way to turn it off if they don't want it.\r\n\r\nSince the root redirector runs as root, we can't just use a config value in the normal user-based config.json, since there might be multiple users on the machine all using keybase.  So the idea here is to allow the user to optionally create a file at `/etc/keybase/config.json` as root, and populate it thusly:\r\n\r\n```json\r\n{\r\n  \"disable-root-redirector\": true\r\n}\r\n```\r\n\r\nThen, we'll post instructions in the docs on how to stop the root redirector and delete `/keybase`, and when things get restarted, we won't try to start it up again.\r\n\r\nTo make that happen, this PR:\r\n* Adds new flags to `keybase config get` for:\r\n  * \"d, direct\": read a value directly from the config file, rather than relying on the Keybase service (and without launching a service, if one isn't already running).\r\n  * \"b, bare\": read a string from the config file without putting quotes around it.  (Not really needed for this PR, but helpful to avoid some sed-hacking in the scripts.)\r\n* Check the root config file in `run_keybase` and the Linux post-installer, and not starting the redirector if needed.\r\n* Check the root config file in OSX before starting the redirector.\r\n\r\ncc: @maxtaco for the `keybase config get` changes.\r\n\r\nIssue: KBFS-2798i","created_at":"2018-02-28T06:02:44Z","updated_at":"2018-02-28T21:55:12Z","closed_at":null,"merged_at":null,"merge_commit_sha":"68cad056c59f32bd78f56883e93a1fc1dbb80287","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jzila","id":59594,"avatar_url":"https://avatars1.githubusercontent.com/u/59594?v=4","gravatar_id":"","url":"https://api.github.com/users/jzila","html_url":"https://github.com/jzila","followers_url":"https://api.github.com/users/jzila/followers","following_url":"https://api.github.com/users/jzila/following{/other_user}","gists_url":"https://api.github.com/users/jzila/gists{/gist_id}","starred_url":"https://api.github.com/users/jzila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzila/subscriptions","organizations_url":"https://api.github.com/users/jzila/orgs","repos_url":"https://api.github.com/users/jzila/repos","events_url":"https://api.github.com/users/jzila/events{/privacy}","received_events_url":"https://api.github.com/users/jzila/received_events","type":"User","site_admin":false},{"login":"songgao","id":255797,"avatar_url":"https://avatars3.githubusercontent.com/u/255797?v=4","gravatar_id":"","url":"https://api.github.com/users/songgao","html_url":"https://github.com/songgao","followers_url":"https://api.github.com/users/songgao/followers","following_url":"https://api.github.com/users/songgao/following{/other_user}","gists_url":"https://api.github.com/users/songgao/gists{/gist_id}","starred_url":"https://api.github.com/users/songgao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songgao/subscriptions","organizations_url":"https://api.github.com/users/songgao/orgs","repos_url":"https://api.github.com/users/songgao/repos","events_url":"https://api.github.com/users/songgao/events{/privacy}","received_events_url":"https://api.github.com/users/songgao/received_events","type":"User","site_admin":false},{"login":"oconnor663","id":860932,"avatar_url":"https://avatars0.githubusercontent.com/u/860932?v=4","gravatar_id":"","url":"https://api.github.com/users/oconnor663","html_url":"https://github.com/oconnor663","followers_url":"https://api.github.com/users/oconnor663/followers","following_url":"https://api.github.com/users/oconnor663/following{/other_user}","gists_url":"https://api.github.com/users/oconnor663/gists{/gist_id}","starred_url":"https://api.github.com/users/oconnor663/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oconnor663/subscriptions","organizations_url":"https://api.github.com/users/oconnor663/orgs","repos_url":"https://api.github.com/users/oconnor663/repos","events_url":"https://api.github.com/users/oconnor663/events{/privacy}","received_events_url":"https://api.github.com/users/oconnor663/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/client/pulls/10724/commits","review_comments_url":"https://api.github.com/repos/keybase/client/pulls/10724/comments","review_comment_url":"https://api.github.com/repos/keybase/client/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/client/issues/10724/comments","statuses_url":"https://api.github.com/repos/keybase/client/statuses/4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b","head":{"label":"keybase:strib/KBFS-2798-turn-off-root-redirector","ref":"strib/KBFS-2798-turn-off-root-redirector","sha":"4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:53:24Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1894,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1894,"watchers":3297,"default_branch":"master"}},"base":{"label":"keybase:strib/KBFS-2782-root-redirector","ref":"strib/KBFS-2782-root-redirector","sha":"97497086f86cef4351eb6c97eb997e6500fc58e7","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:53:24Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1894,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1894,"watchers":3297,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/10724"},"html":{"href":"https://github.com/keybase/client/pull/10724"},"issue":{"href":"https://api.github.com/repos/keybase/client/issues/10724"},"comments":{"href":"https://api.github.com/repos/keybase/client/issues/10724/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/client/pulls/10724/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/client/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/client/pulls/10724/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/client/statuses/4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:55:12Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312702184","type":"PushEvent","actor":{"id":516435,"login":"chrisnojima","display_login":"chrisnojima","gravatar_id":"","url":"https://api.github.com/users/chrisnojima","avatar_url":"https://avatars.githubusercontent.com/u/516435?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366760543,"size":1,"distinct_size":1,"ref":"refs/heads/nojima/DESKTOP-chat-clean-11","head":"951cc543e88a0097dcca1abb1f59daa62c143225","before":"79f170691b99134697130be20d59fc0ce64596d3","commits":[{"sha":"951cc543e88a0097dcca1abb1f59daa62c143225","author":{"email":"cnojima@keyba.se","name":"chrisnojima"},"message":"WIP","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/951cc543e88a0097dcca1abb1f59daa62c143225"}]},"public":true,"created_at":"2018-02-28T21:53:24Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312695465","type":"PushEvent","actor":{"id":11968340,"login":"buoyad","display_login":"buoyad","gravatar_id":"","url":"https://api.github.com/users/buoyad","avatar_url":"https://avatars.githubusercontent.com/u/11968340?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366756881,"size":1,"distinct_size":1,"ref":"refs/heads/master","head":"9613c18a266088c2e3af95f7529090ab71d4c432","before":"c88f6f7e0a0780839f3010f61192856853f208cd","commits":[{"sha":"9613c18a266088c2e3af95f7529090ab71d4c432","author":{"email":"danny.a95@gmail.com","name":"Daniel Ayoub"},"message":"Make entire teams page scrollable (#10680)\n\n* initial refactor\r\n\r\n* WIP\r\n\r\n* WIP\r\n\r\n* factor out team header\r\n\r\n* clean up teams page\r\n\r\n* WIP\r\n\r\n* WIP\r\n\r\n* subteams work\r\n\r\n* initial item size estimator\r\n\r\n* gather subteam and member row types\r\n\r\n* initial sectionList on mobile\r\n\r\n* fix key problems\r\n\r\n* minor cleanup\r\n\r\n* requests and invites work\r\n\r\n* settings works on mobile\r\n\r\n* styling on desktop & mobile\r\n\r\n* type\r\n\r\n* WIP chat button\r\n\r\n* bail on chat button\r\n\r\n* better type\r\n\r\n* row key\r\n\r\n* bugfix\r\n\r\n* reenable chat button\r\n\r\n* better popup menu\r\n\r\n* disable chat button for upcoming release\r\n\r\n* chat button works","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/9613c18a266088c2e3af95f7529090ab71d4c432"}]},"public":true,"created_at":"2018-02-28T21:52:03Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312694781","type":"PullRequestEvent","actor":{"id":11968340,"login":"buoyad","display_login":"buoyad","gravatar_id":"","url":"https://api.github.com/users/buoyad","avatar_url":"https://avatars.githubusercontent.com/u/11968340?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"closed","number":10680,"pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10680","id":171121696,"html_url":"https://github.com/keybase/client/pull/10680","diff_url":"https://github.com/keybase/client/pull/10680.diff","patch_url":"https://github.com/keybase/client/pull/10680.patch","issue_url":"https://api.github.com/repos/keybase/client/issues/10680","number":10680,"state":"closed","locked":false,"title":"Make entire teams page scrollable","user":{"login":"buoyad","id":11968340,"avatar_url":"https://avatars1.githubusercontent.com/u/11968340?v=4","gravatar_id":"","url":"https://api.github.com/users/buoyad","html_url":"https://github.com/buoyad","followers_url":"https://api.github.com/users/buoyad/followers","following_url":"https://api.github.com/users/buoyad/following{/other_user}","gists_url":"https://api.github.com/users/buoyad/gists{/gist_id}","starred_url":"https://api.github.com/users/buoyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/buoyad/subscriptions","organizations_url":"https://api.github.com/users/buoyad/orgs","repos_url":"https://api.github.com/users/buoyad/repos","events_url":"https://api.github.com/users/buoyad/events{/privacy}","received_events_url":"https://api.github.com/users/buoyad/received_events","type":"User","site_admin":false},"body":"r? @keybase/react-hackers \r\n\r\n~(side note: I bailed on the chat button due to a bug cc @mmaxim @malgorithms)~\r\n\r\nedit: put the chat button back!","created_at":"2018-02-23T21:34:42Z","updated_at":"2018-02-28T21:51:54Z","closed_at":"2018-02-28T21:51:54Z","merged_at":"2018-02-28T21:51:54Z","merge_commit_sha":"9613c18a266088c2e3af95f7529090ab71d4c432","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/client/pulls/10680/commits","review_comments_url":"https://api.github.com/repos/keybase/client/pulls/10680/comments","review_comment_url":"https://api.github.com/repos/keybase/client/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/client/issues/10680/comments","statuses_url":"https://api.github.com/repos/keybase/client/statuses/b41ed064d347f773d5735bf954d0cbffa64310df","head":{"label":"keybase:danny/DESKTOP-6135/team-scroll","ref":"danny/DESKTOP-6135/team-scroll","sha":"b41ed064d347f773d5735bf954d0cbffa64310df","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:51:54Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1894,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1894,"watchers":3297,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"d55b2546d7ec377a49c9e8230ffd949e7ce9446a","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:51:54Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1894,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1894,"watchers":3297,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/10680"},"html":{"href":"https://github.com/keybase/client/pull/10680"},"issue":{"href":"https://api.github.com/repos/keybase/client/issues/10680"},"comments":{"href":"https://api.github.com/repos/keybase/client/issues/10680/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/client/pulls/10680/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/client/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/client/pulls/10680/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/client/statuses/b41ed064d347f773d5735bf954d0cbffa64310df"}},"author_association":"MEMBER","merged":true,"mergeable":null,"rebaseable":null,"mergeable_state":"unknown","merged_by":{"login":"buoyad","id":11968340,"avatar_url":"https://avatars1.githubusercontent.com/u/11968340?v=4","gravatar_id":"","url":"https://api.github.com/users/buoyad","html_url":"https://github.com/buoyad","followers_url":"https://api.github.com/users/buoyad/followers","following_url":"https://api.github.com/users/buoyad/following{/other_user}","gists_url":"https://api.github.com/users/buoyad/gists{/gist_id}","starred_url":"https://api.github.com/users/buoyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/buoyad/subscriptions","organizations_url":"https://api.github.com/users/buoyad/orgs","repos_url":"https://api.github.com/users/buoyad/repos","events_url":"https://api.github.com/users/buoyad/events{/privacy}","received_events_url":"https://api.github.com/users/buoyad/received_events","type":"User","site_admin":false},"comments":1,"review_comments":6,"maintainer_can_modify":false,"commits":29,"additions":857,"deletions":599,"changed_files":19}},"public":true,"created_at":"2018-02-28T21:51:55Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312691649","type":"PushEvent","actor":{"id":862397,"login":"zanderz","display_login":"zanderz","gravatar_id":"","url":"https://api.github.com/users/zanderz","avatar_url":"https://avatars.githubusercontent.com/u/862397?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366754970,"size":1,"distinct_size":1,"ref":"refs/heads/zanderz/installer_2018.02.25","head":"9e2057cb4d1732b27e1929b03da078620a2e2d48","before":"959a9f00cbdd7cd9eee4744d6aac73cd04c7ff6c","commits":[{"sha":"9e2057cb4d1732b27e1929b03da078620a2e2d48","author":{"email":"steve@keyba.se","name":"Steve Sanders"},"message":"typo","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/9e2057cb4d1732b27e1929b03da078620a2e2d48"}]},"public":true,"created_at":"2018-02-28T21:51:17Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312689176","type":"PullRequestReviewCommentEvent","actor":{"id":8516691,"login":"strib","display_login":"strib","gravatar_id":"","url":"https://api.github.com/users/strib","avatar_url":"https://avatars.githubusercontent.com/u/8516691?"},"repo":{"id":59787605,"name":"keybase/kbfs","url":"https://api.github.com/repos/keybase/kbfs"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171396812","pull_request_review_id":100242908,"id":171396812,"diff_hunk":"@@ -0,0 +1,267 @@\n+// Copyright 2018 Keybase Inc. All rights reserved.\n+// Use of this source code is governed by a BSD\n+// license that can be found in the LICENSE file.\n+\n+package main\n+\n+import (\n+\t\"context\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"os/signal\"\n+\t\"os/user\"\n+\t\"path/filepath\"\n+\t\"runtime\"\n+\t\"sort\"\n+\t\"strconv\"\n+\t\"strings\"\n+\t\"sync\"\n+\t\"syscall\"\n+\t\"time\"\n+\n+\t\"bazil.org/fuse\"\n+\t\"bazil.org/fuse/fs\"\n+\t\"github.com/strib/gomounts\"\n+)\n+\n+var kbfusePath = fuse.OSXFUSEPaths{\n+\tDevicePrefix: \"/dev/kbfuse\",\n+\tLoad:         \"/Library/Filesystems/kbfuse.fs/Contents/Resources/load_kbfuse\",\n+\tMount:        \"/Library/Filesystems/kbfuse.fs/Contents/Resources/mount_kbfuse\",\n+\tDaemonVar:    \"MOUNT_KBFUSE_DAEMON_PATH\",\n+}\n+\n+const (\n+\tmountpointTimeout = 5 * time.Second\n+)\n+\n+type symlink struct {\n+\tlink string\n+}\n+\n+func (s symlink) Attr(ctx context.Context, a *fuse.Attr) (err error) {\n+\ta.Mode = os.ModeSymlink | a.Mode | 0555\n+\ta.Valid = 0\n+\treturn nil\n+}\n+\n+func (s symlink) Readlink(ctx context.Context, req *fuse.ReadlinkRequest) (\n+\tlink string, err error) {\n+\treturn s.link, nil\n+}\n+\n+type cacheEntry struct {\n+\tmountpoint string\n+\ttime       time.Time\n+}\n+\n+type root struct {\n+\tlock            sync.RWMutex\n+\tmountpointCache map[uint32]cacheEntry\n+}\n+\n+func newRoot() *root {\n+\treturn &root{\n+\t\tmountpointCache: make(map[uint32]cacheEntry),\n+\t}\n+}\n+\n+func (r *root) Root() (fs.Node, error) {\n+\treturn r, nil\n+}\n+\n+func (r *root) Attr(ctx context.Context, attr *fuse.Attr) error {\n+\tattr.Mode = os.ModeDir | 0555\n+\treturn nil\n+}\n+\n+func (r *root) getCachedMountpoint(uid uint32) string {\n+\tr.lock.RLock()\n+\tdefer r.lock.RUnlock()\n+\tentry, ok := r.mountpointCache[uid]\n+\tif !ok {\n+\t\treturn \"\"\n+\t}\n+\tnow := time.Now()\n+\tif now.Sub(entry.time) > mountpointTimeout {\n+\t\t// Don't bother deleting the entry, since the caller should\n+\t\t// just overwrite it.\n+\t\treturn \"\"\n+\t}\n+\treturn entry.mountpoint\n+}\n+\n+func (r *root) findKBFSMount(ctx context.Context) (\n+\tmountpoint string, err error) {\n+\tuid := ctx.Value(fs.CtxHeaderUIDKey).(uint32)\n+\t// Don't let the root see anything here; we don't want a symlink\n+\t// loop back to this mount.\n+\tif uid == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\n+\tmountpoint = r.getCachedMountpoint(uid)\n+\tif mountpoint != \"\" {\n+\t\treturn mountpoint, nil\n+\t}\n+\n+\tdefer func() {\n+\t\tif err != nil {\n+\t\t\treturn\n+\t\t}\n+\t\t// Cache the entry if we didn't hit an error.\n+\t\tr.lock.Lock()\n+\t\tdefer r.lock.Unlock()\n+\t\tr.mountpointCache[uid] = cacheEntry{\n+\t\t\tmountpoint: mountpoint,\n+\t\t\ttime:       time.Now(),\n+\t\t}\n+\t}()\n+\n+\tu, err := user.LookupId(strconv.FormatUint(uint64(uid), 10))\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\n+\tvols, err := gomounts.GetMountedVolumes()\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\tfuseType := \"fuse\"\n+\tif runtime.GOOS == \"darwin\" {\n+\t\tfuseType = \"kbfuse\"\n+\t}\n+\tvar fuseMountPoints []string\n+\tfor _, v := range vols {\n+\t\tif v.Type != fuseType {\n+\t\t\tcontinue\n+\t\t}\n+\t\tif v.Owner != u.Uid {\n+\t\t\tcontinue\n+\t\t}\n+\t\tfuseMountPoints = append(fuseMountPoints, v.Path)\n+\t}\n+\n+\tif len(fuseMountPoints) == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\tif len(fuseMountPoints) == 1 {\n+\t\treturn fuseMountPoints[0], nil\n+\t}\n+\n+\t// If there is more than one, pick the first one alphabetically\n+\t// that has \"keybase\" in the path.\n+\tsort.Strings(fuseMountPoints)\n+\tfor _, mp := range fuseMountPoints {\n+\t\t// TODO: a better regexp that will rule out keybase.staging if\n+\t\t// we're in prod mode, etc.\n+\t\tif !strings.Contains(mp, \"keybase\") {\n+\t\t\tcontinue\n+\t\t}\n+\t\t// Double-check that this is a real KBFS mount.\n+\t\tif _, err := os.Stat(filepath.Join(mp, \".kbfs_error\")); err != nil {\n+\t\t\tcontinue\n+\t\t}\n+\t\treturn mp, nil\n+\t}\n+\n+\t// Give up and return the first one.\n+\treturn fuseMountPoints[0], nil\n+}\n+\n+func (r *root) ReadDirAll(ctx context.Context) ([]fuse.Dirent, error) {\n+\t_, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\tif err == fuse.ENOENT {\n+\t\t\treturn []fuse.Dirent{}, nil\n+\t\t} else {\n+\t\t\treturn []fuse.Dirent{}, err\n+\t\t}\n+\t}\n+\n+\t// TODO: show the `kbfs.error.txt\" and \"kbfs.nologin.txt\" files if\n+\t// they exist?  As root, it is hard to figure out if they're\n+\t// there, though.\n+\treturn []fuse.Dirent{\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"private\",\n+\t\t},\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"public\",\n+\t\t},\n+\t\tfuse.Dirent{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"team\",\n+\t\t},\n+\t}, nil\n+}\n+\n+func (r *root) Lookup(\n+\tctx context.Context, req *fuse.LookupRequest, resp *fuse.LookupResponse) (\n+\tn fs.Node, err error) {\n+\tmountpoint, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\n+\tresp.EntryValid = 0\n+\tswitch req.Name {\n+\tcase \"private\", \"public\", \"team\", \".kbfs_error\", \".kbfs_metrics\",\n+\t\t\".kbfs_profiles\", \".kbfs_reset_caches\", \".kbfs_status\",\n+\t\t\"kbfs.error.txt\", \"kbfs.nologin.txt\", \".kbfs_enable_auto_journals\",\n+\t\t\".kbfs_disable_auto_journals\", \".kbfs_enable_block_prefetching\",\n+\t\t\".kbfs_disable_block_prefetching\", \".kbfs_enable_debug_server\",\n+\t\t\".kbfs_disable_debug_server\":\n+\t\treturn symlink{filepath.Join(mountpoint, req.Name)}, nil\n+\t}\n+\treturn nil, fuse.ENOENT\n+}\n+\n+func main() {\n+\tcurrUser, err := user.Current()\n+\tif err != nil {\n+\t\tpanic(err)\n+\t}\n+\tif currUser.Uid != \"0\" {\n+\t\truntime.LockOSThread()\n+\t\t_, _, errNo := syscall.Syscall(syscall.SYS_SETUID, 0, 0, 0)","path":"redirector/go/main.go","position":228,"original_position":229,"commit_id":"a375bbaa852f7c4c5475526da029481d313d80e8","original_commit_id":"4a9c54931293f10b5568f92acdec99a7e74547c5","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"I guess maybe it has something to do with the difference between linking into the .so file and calling an external mount program?  Maybe the latter doesn't get run as root unless you officially set the uid?","created_at":"2018-02-28T21:50:46Z","updated_at":"2018-02-28T21:50:47Z","html_url":"https://github.com/keybase/kbfs/pull/1496#discussion_r171396812","pull_request_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171396812"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496#discussion_r171396812"},"pull_request":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"}},"in_reply_to_id":171385042},"pull_request":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","id":172070599,"html_url":"https://github.com/keybase/kbfs/pull/1496","diff_url":"https://github.com/keybase/kbfs/pull/1496.diff","patch_url":"https://github.com/keybase/kbfs/pull/1496.patch","issue_url":"https://api.github.com/repos/keybase/kbfs/issues/1496","number":1496,"state":"open","locked":false,"title":"redirector: a Go implementation for the root redirector","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"This implementation of the root redirector will likely be used for macOS, at least until we figure out the kbfuse+Rust situation.\r\n\r\nNote that I needed some new bazil.org/fuse options, so I forked it to github.comkeybase/fuse and added two new features:\r\n* A NoBrowse() option that keeps the redirector from showing up in the Finder (instead, the specific user's mount will show up).\r\n* Adding the requesting user's UID to the context for every request, since `ReadDirAll` needs to know whether the requesting user has a valid mountpoint or not.  The bazil.org/fuse interface for `ReadDirAll` doesn't pass this down, so putting it in the context seemed like the easiest option for now.\r\n\r\nIssue: KBFS-2774","created_at":"2018-02-28T20:58:07Z","updated_at":"2018-02-28T21:50:47Z","closed_at":null,"merged_at":null,"merge_commit_sha":"437c5c76f895a2fc4092ddecb665a8ea1424e823","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jzila","id":59594,"avatar_url":"https://avatars1.githubusercontent.com/u/59594?v=4","gravatar_id":"","url":"https://api.github.com/users/jzila","html_url":"https://github.com/jzila","followers_url":"https://api.github.com/users/jzila/followers","following_url":"https://api.github.com/users/jzila/following{/other_user}","gists_url":"https://api.github.com/users/jzila/gists{/gist_id}","starred_url":"https://api.github.com/users/jzila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzila/subscriptions","organizations_url":"https://api.github.com/users/jzila/orgs","repos_url":"https://api.github.com/users/jzila/repos","events_url":"https://api.github.com/users/jzila/events{/privacy}","received_events_url":"https://api.github.com/users/jzila/received_events","type":"User","site_admin":false},{"login":"songgao","id":255797,"avatar_url":"https://avatars3.githubusercontent.com/u/255797?v=4","gravatar_id":"","url":"https://api.github.com/users/songgao","html_url":"https://github.com/songgao","followers_url":"https://api.github.com/users/songgao/followers","following_url":"https://api.github.com/users/songgao/following{/other_user}","gists_url":"https://api.github.com/users/songgao/gists{/gist_id}","starred_url":"https://api.github.com/users/songgao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songgao/subscriptions","organizations_url":"https://api.github.com/users/songgao/orgs","repos_url":"https://api.github.com/users/songgao/repos","events_url":"https://api.github.com/users/songgao/events{/privacy}","received_events_url":"https://api.github.com/users/songgao/received_events","type":"User","site_admin":false},{"login":"akalin-keybase","id":13270622,"avatar_url":"https://avatars3.githubusercontent.com/u/13270622?v=4","gravatar_id":"","url":"https://api.github.com/users/akalin-keybase","html_url":"https://github.com/akalin-keybase","followers_url":"https://api.github.com/users/akalin-keybase/followers","following_url":"https://api.github.com/users/akalin-keybase/following{/other_user}","gists_url":"https://api.github.com/users/akalin-keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/akalin-keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akalin-keybase/subscriptions","organizations_url":"https://api.github.com/users/akalin-keybase/orgs","repos_url":"https://api.github.com/users/akalin-keybase/repos","events_url":"https://api.github.com/users/akalin-keybase/events{/privacy}","received_events_url":"https://api.github.com/users/akalin-keybase/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits","review_comments_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments","review_comment_url":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8","head":{"label":"keybase:strib/KBFS-2774-mount-redirector","ref":"strib/KBFS-2774-mount-redirector","sha":"a375bbaa852f7c4c5475526da029481d313d80e8","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48537,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"478a58b55a4605e2abe8699e32adc066bf1df7ee","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48537,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496"},"issue":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496"},"comments":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:50:46Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312685619","type":"PullRequestEvent","actor":{"id":866815,"login":"maxtaco","display_login":"maxtaco","gravatar_id":"","url":"https://api.github.com/users/maxtaco","avatar_url":"https://avatars.githubusercontent.com/u/866815?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"opened","number":10735,"pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10735","id":172082871,"html_url":"https://github.com/keybase/client/pull/10735","diff_url":"https://github.com/keybase/client/pull/10735.diff","patch_url":"https://github.com/keybase/client/pull/10735.patch","issue_url":"https://api.github.com/repos/keybase/client/issues/10735","number":10735,"state":"open","locked":false,"title":"reader support for new merkle-signing key","user":{"login":"maxtaco","id":866815,"avatar_url":"https://avatars0.githubusercontent.com/u/866815?v=4","gravatar_id":"","url":"https://api.github.com/users/maxtaco","html_url":"https://github.com/maxtaco","followers_url":"https://api.github.com/users/maxtaco/followers","following_url":"https://api.github.com/users/maxtaco/following{/other_user}","gists_url":"https://api.github.com/users/maxtaco/gists{/gist_id}","starred_url":"https://api.github.com/users/maxtaco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxtaco/subscriptions","organizations_url":"https://api.github.com/users/maxtaco/orgs","repos_url":"https://api.github.com/users/maxtaco/repos","events_url":"https://api.github.com/users/maxtaco/events{/privacy}","received_events_url":"https://api.github.com/users/maxtaco/received_events","type":"User","site_admin":false},"body":"- new key is an EdDSA key\r\n- therefore don't use the PGP-specific fields in the merkle root, they weren't checked anyways\r\n- prepare current clients (test and prod) for the new keys, though it'll be a while before we roll this out","created_at":"2018-02-28T21:50:05Z","updated_at":"2018-02-28T21:50:05Z","closed_at":null,"merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/client/pulls/10735/commits","review_comments_url":"https://api.github.com/repos/keybase/client/pulls/10735/comments","review_comment_url":"https://api.github.com/repos/keybase/client/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/client/issues/10735/comments","statuses_url":"https://api.github.com/repos/keybase/client/statuses/7d72ab2264701719959858c3a3fca62da2368474","head":{"label":"keybase:maxtaco/CORE-7305","ref":"maxtaco/CORE-7305","sha":"7d72ab2264701719959858c3a3fca62da2368474","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:46:46Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1895,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1895,"watchers":3297,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"c88f6f7e0a0780839f3010f61192856853f208cd","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:46:46Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1895,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1895,"watchers":3297,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/10735"},"html":{"href":"https://github.com/keybase/client/pull/10735"},"issue":{"href":"https://api.github.com/repos/keybase/client/issues/10735"},"comments":{"href":"https://api.github.com/repos/keybase/client/issues/10735/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/client/pulls/10735/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/client/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/client/pulls/10735/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/client/statuses/7d72ab2264701719959858c3a3fca62da2368474"}},"author_association":"CONTRIBUTOR","merged":false,"mergeable":null,"rebaseable":null,"mergeable_state":"unknown","merged_by":null,"comments":0,"review_comments":0,"maintainer_can_modify":false,"commits":1,"additions":2,"deletions":4,"changed_files":2}},"public":true,"created_at":"2018-02-28T21:50:05Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312678444","type":"PullRequestReviewCommentEvent","actor":{"id":8516691,"login":"strib","display_login":"strib","gravatar_id":"","url":"https://api.github.com/users/strib","avatar_url":"https://avatars.githubusercontent.com/u/8516691?"},"repo":{"id":59787605,"name":"keybase/kbfs","url":"https://api.github.com/repos/keybase/kbfs"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171396177","pull_request_review_id":100242113,"id":171396177,"diff_hunk":"@@ -0,0 +1,267 @@\n+// Copyright 2018 Keybase Inc. All rights reserved.\n+// Use of this source code is governed by a BSD\n+// license that can be found in the LICENSE file.\n+\n+package main\n+\n+import (\n+\t\"context\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"os/signal\"\n+\t\"os/user\"\n+\t\"path/filepath\"\n+\t\"runtime\"\n+\t\"sort\"\n+\t\"strconv\"\n+\t\"strings\"\n+\t\"sync\"\n+\t\"syscall\"\n+\t\"time\"\n+\n+\t\"bazil.org/fuse\"\n+\t\"bazil.org/fuse/fs\"\n+\t\"github.com/strib/gomounts\"\n+)\n+\n+var kbfusePath = fuse.OSXFUSEPaths{\n+\tDevicePrefix: \"/dev/kbfuse\",\n+\tLoad:         \"/Library/Filesystems/kbfuse.fs/Contents/Resources/load_kbfuse\",\n+\tMount:        \"/Library/Filesystems/kbfuse.fs/Contents/Resources/mount_kbfuse\",\n+\tDaemonVar:    \"MOUNT_KBFUSE_DAEMON_PATH\",\n+}\n+\n+const (\n+\tmountpointTimeout = 5 * time.Second\n+)\n+\n+type symlink struct {\n+\tlink string\n+}\n+\n+func (s symlink) Attr(ctx context.Context, a *fuse.Attr) (err error) {\n+\ta.Mode = os.ModeSymlink | a.Mode | 0555\n+\ta.Valid = 0\n+\treturn nil\n+}\n+\n+func (s symlink) Readlink(ctx context.Context, req *fuse.ReadlinkRequest) (\n+\tlink string, err error) {\n+\treturn s.link, nil\n+}\n+\n+type cacheEntry struct {\n+\tmountpoint string\n+\ttime       time.Time\n+}\n+\n+type root struct {\n+\tlock            sync.RWMutex\n+\tmountpointCache map[uint32]cacheEntry\n+}\n+\n+func newRoot() *root {\n+\treturn &root{\n+\t\tmountpointCache: make(map[uint32]cacheEntry),\n+\t}\n+}\n+\n+func (r *root) Root() (fs.Node, error) {\n+\treturn r, nil\n+}\n+\n+func (r *root) Attr(ctx context.Context, attr *fuse.Attr) error {\n+\tattr.Mode = os.ModeDir | 0555\n+\treturn nil\n+}\n+\n+func (r *root) getCachedMountpoint(uid uint32) string {\n+\tr.lock.RLock()\n+\tdefer r.lock.RUnlock()\n+\tentry, ok := r.mountpointCache[uid]\n+\tif !ok {\n+\t\treturn \"\"\n+\t}\n+\tnow := time.Now()\n+\tif now.Sub(entry.time) > mountpointTimeout {\n+\t\t// Don't bother deleting the entry, since the caller should\n+\t\t// just overwrite it.\n+\t\treturn \"\"\n+\t}\n+\treturn entry.mountpoint\n+}\n+\n+func (r *root) findKBFSMount(ctx context.Context) (\n+\tmountpoint string, err error) {\n+\tuid := ctx.Value(fs.CtxHeaderUIDKey).(uint32)\n+\t// Don't let the root see anything here; we don't want a symlink\n+\t// loop back to this mount.\n+\tif uid == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\n+\tmountpoint = r.getCachedMountpoint(uid)\n+\tif mountpoint != \"\" {\n+\t\treturn mountpoint, nil\n+\t}\n+\n+\tdefer func() {\n+\t\tif err != nil {\n+\t\t\treturn\n+\t\t}\n+\t\t// Cache the entry if we didn't hit an error.\n+\t\tr.lock.Lock()\n+\t\tdefer r.lock.Unlock()\n+\t\tr.mountpointCache[uid] = cacheEntry{\n+\t\t\tmountpoint: mountpoint,\n+\t\t\ttime:       time.Now(),\n+\t\t}\n+\t}()\n+\n+\tu, err := user.LookupId(strconv.FormatUint(uint64(uid), 10))\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\n+\tvols, err := gomounts.GetMountedVolumes()\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\tfuseType := \"fuse\"\n+\tif runtime.GOOS == \"darwin\" {\n+\t\tfuseType = \"kbfuse\"\n+\t}\n+\tvar fuseMountPoints []string\n+\tfor _, v := range vols {\n+\t\tif v.Type != fuseType {\n+\t\t\tcontinue\n+\t\t}\n+\t\tif v.Owner != u.Uid {\n+\t\t\tcontinue\n+\t\t}\n+\t\tfuseMountPoints = append(fuseMountPoints, v.Path)\n+\t}\n+\n+\tif len(fuseMountPoints) == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\tif len(fuseMountPoints) == 1 {\n+\t\treturn fuseMountPoints[0], nil\n+\t}\n+\n+\t// If there is more than one, pick the first one alphabetically\n+\t// that has \"keybase\" in the path.\n+\tsort.Strings(fuseMountPoints)\n+\tfor _, mp := range fuseMountPoints {\n+\t\t// TODO: a better regexp that will rule out keybase.staging if\n+\t\t// we're in prod mode, etc.\n+\t\tif !strings.Contains(mp, \"keybase\") {\n+\t\t\tcontinue\n+\t\t}\n+\t\t// Double-check that this is a real KBFS mount.\n+\t\tif _, err := os.Stat(filepath.Join(mp, \".kbfs_error\")); err != nil {\n+\t\t\tcontinue\n+\t\t}\n+\t\treturn mp, nil\n+\t}\n+\n+\t// Give up and return the first one.\n+\treturn fuseMountPoints[0], nil\n+}\n+\n+func (r *root) ReadDirAll(ctx context.Context) ([]fuse.Dirent, error) {\n+\t_, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\tif err == fuse.ENOENT {\n+\t\t\treturn []fuse.Dirent{}, nil\n+\t\t} else {\n+\t\t\treturn []fuse.Dirent{}, err\n+\t\t}\n+\t}\n+\n+\t// TODO: show the `kbfs.error.txt\" and \"kbfs.nologin.txt\" files if\n+\t// they exist?  As root, it is hard to figure out if they're\n+\t// there, though.\n+\treturn []fuse.Dirent{\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"private\",\n+\t\t},\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"public\",\n+\t\t},\n+\t\tfuse.Dirent{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"team\",\n+\t\t},\n+\t}, nil\n+}\n+\n+func (r *root) Lookup(\n+\tctx context.Context, req *fuse.LookupRequest, resp *fuse.LookupResponse) (\n+\tn fs.Node, err error) {\n+\tmountpoint, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\n+\tresp.EntryValid = 0\n+\tswitch req.Name {\n+\tcase \"private\", \"public\", \"team\", \".kbfs_error\", \".kbfs_metrics\",\n+\t\t\".kbfs_profiles\", \".kbfs_reset_caches\", \".kbfs_status\",\n+\t\t\"kbfs.error.txt\", \"kbfs.nologin.txt\", \".kbfs_enable_auto_journals\",\n+\t\t\".kbfs_disable_auto_journals\", \".kbfs_enable_block_prefetching\",\n+\t\t\".kbfs_disable_block_prefetching\", \".kbfs_enable_debug_server\",\n+\t\t\".kbfs_disable_debug_server\":\n+\t\treturn symlink{filepath.Join(mountpoint, req.Name)}, nil\n+\t}\n+\treturn nil, fuse.ENOENT\n+}\n+\n+func main() {\n+\tcurrUser, err := user.Current()\n+\tif err != nil {\n+\t\tpanic(err)\n+\t}\n+\tif currUser.Uid != \"0\" {\n+\t\truntime.LockOSThread()\n+\t\t_, _, errNo := syscall.Syscall(syscall.SYS_SETUID, 0, 0, 0)","path":"redirector/go/main.go","position":228,"original_position":229,"commit_id":"a375bbaa852f7c4c5475526da029481d313d80e8","original_commit_id":"4a9c54931293f10b5568f92acdec99a7e74547c5","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"Say what?  Yeah you're right, I just tried your branch and it worked for me (in `/tmp/`).  Stumped.","created_at":"2018-02-28T21:48:36Z","updated_at":"2018-02-28T21:48:36Z","html_url":"https://github.com/keybase/kbfs/pull/1496#discussion_r171396177","pull_request_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171396177"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496#discussion_r171396177"},"pull_request":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"}},"in_reply_to_id":171385042},"pull_request":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","id":172070599,"html_url":"https://github.com/keybase/kbfs/pull/1496","diff_url":"https://github.com/keybase/kbfs/pull/1496.diff","patch_url":"https://github.com/keybase/kbfs/pull/1496.patch","issue_url":"https://api.github.com/repos/keybase/kbfs/issues/1496","number":1496,"state":"open","locked":false,"title":"redirector: a Go implementation for the root redirector","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"This implementation of the root redirector will likely be used for macOS, at least until we figure out the kbfuse+Rust situation.\r\n\r\nNote that I needed some new bazil.org/fuse options, so I forked it to github.comkeybase/fuse and added two new features:\r\n* A NoBrowse() option that keeps the redirector from showing up in the Finder (instead, the specific user's mount will show up).\r\n* Adding the requesting user's UID to the context for every request, since `ReadDirAll` needs to know whether the requesting user has a valid mountpoint or not.  The bazil.org/fuse interface for `ReadDirAll` doesn't pass this down, so putting it in the context seemed like the easiest option for now.\r\n\r\nIssue: KBFS-2774","created_at":"2018-02-28T20:58:07Z","updated_at":"2018-02-28T21:48:36Z","closed_at":null,"merged_at":null,"merge_commit_sha":"437c5c76f895a2fc4092ddecb665a8ea1424e823","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jzila","id":59594,"avatar_url":"https://avatars1.githubusercontent.com/u/59594?v=4","gravatar_id":"","url":"https://api.github.com/users/jzila","html_url":"https://github.com/jzila","followers_url":"https://api.github.com/users/jzila/followers","following_url":"https://api.github.com/users/jzila/following{/other_user}","gists_url":"https://api.github.com/users/jzila/gists{/gist_id}","starred_url":"https://api.github.com/users/jzila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzila/subscriptions","organizations_url":"https://api.github.com/users/jzila/orgs","repos_url":"https://api.github.com/users/jzila/repos","events_url":"https://api.github.com/users/jzila/events{/privacy}","received_events_url":"https://api.github.com/users/jzila/received_events","type":"User","site_admin":false},{"login":"songgao","id":255797,"avatar_url":"https://avatars3.githubusercontent.com/u/255797?v=4","gravatar_id":"","url":"https://api.github.com/users/songgao","html_url":"https://github.com/songgao","followers_url":"https://api.github.com/users/songgao/followers","following_url":"https://api.github.com/users/songgao/following{/other_user}","gists_url":"https://api.github.com/users/songgao/gists{/gist_id}","starred_url":"https://api.github.com/users/songgao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songgao/subscriptions","organizations_url":"https://api.github.com/users/songgao/orgs","repos_url":"https://api.github.com/users/songgao/repos","events_url":"https://api.github.com/users/songgao/events{/privacy}","received_events_url":"https://api.github.com/users/songgao/received_events","type":"User","site_admin":false},{"login":"akalin-keybase","id":13270622,"avatar_url":"https://avatars3.githubusercontent.com/u/13270622?v=4","gravatar_id":"","url":"https://api.github.com/users/akalin-keybase","html_url":"https://github.com/akalin-keybase","followers_url":"https://api.github.com/users/akalin-keybase/followers","following_url":"https://api.github.com/users/akalin-keybase/following{/other_user}","gists_url":"https://api.github.com/users/akalin-keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/akalin-keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akalin-keybase/subscriptions","organizations_url":"https://api.github.com/users/akalin-keybase/orgs","repos_url":"https://api.github.com/users/akalin-keybase/repos","events_url":"https://api.github.com/users/akalin-keybase/events{/privacy}","received_events_url":"https://api.github.com/users/akalin-keybase/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits","review_comments_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments","review_comment_url":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8","head":{"label":"keybase:strib/KBFS-2774-mount-redirector","ref":"strib/KBFS-2774-mount-redirector","sha":"a375bbaa852f7c4c5475526da029481d313d80e8","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"478a58b55a4605e2abe8699e32adc066bf1df7ee","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496"},"issue":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496"},"comments":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:48:36Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312673973","type":"PullRequestReviewCommentEvent","actor":{"id":860932,"login":"oconnor663","display_login":"oconnor663","gravatar_id":"","url":"https://api.github.com/users/oconnor663","avatar_url":"https://avatars.githubusercontent.com/u/860932?"},"repo":{"id":59787605,"name":"keybase/kbfs","url":"https://api.github.com/repos/keybase/kbfs"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171395921","pull_request_review_id":100241825,"id":171395921,"diff_hunk":"@@ -0,0 +1,267 @@\n+// Copyright 2018 Keybase Inc. All rights reserved.\n+// Use of this source code is governed by a BSD\n+// license that can be found in the LICENSE file.\n+\n+package main\n+\n+import (\n+\t\"context\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"os/signal\"\n+\t\"os/user\"\n+\t\"path/filepath\"\n+\t\"runtime\"\n+\t\"sort\"\n+\t\"strconv\"\n+\t\"strings\"\n+\t\"sync\"\n+\t\"syscall\"\n+\t\"time\"\n+\n+\t\"bazil.org/fuse\"\n+\t\"bazil.org/fuse/fs\"\n+\t\"github.com/strib/gomounts\"\n+)\n+\n+var kbfusePath = fuse.OSXFUSEPaths{\n+\tDevicePrefix: \"/dev/kbfuse\",\n+\tLoad:         \"/Library/Filesystems/kbfuse.fs/Contents/Resources/load_kbfuse\",\n+\tMount:        \"/Library/Filesystems/kbfuse.fs/Contents/Resources/mount_kbfuse\",\n+\tDaemonVar:    \"MOUNT_KBFUSE_DAEMON_PATH\",\n+}\n+\n+const (\n+\tmountpointTimeout = 5 * time.Second\n+)\n+\n+type symlink struct {\n+\tlink string\n+}\n+\n+func (s symlink) Attr(ctx context.Context, a *fuse.Attr) (err error) {\n+\ta.Mode = os.ModeSymlink | a.Mode | 0555\n+\ta.Valid = 0\n+\treturn nil\n+}\n+\n+func (s symlink) Readlink(ctx context.Context, req *fuse.ReadlinkRequest) (\n+\tlink string, err error) {\n+\treturn s.link, nil\n+}\n+\n+type cacheEntry struct {\n+\tmountpoint string\n+\ttime       time.Time\n+}\n+\n+type root struct {\n+\tlock            sync.RWMutex\n+\tmountpointCache map[uint32]cacheEntry\n+}\n+\n+func newRoot() *root {\n+\treturn &root{\n+\t\tmountpointCache: make(map[uint32]cacheEntry),\n+\t}\n+}\n+\n+func (r *root) Root() (fs.Node, error) {\n+\treturn r, nil\n+}\n+\n+func (r *root) Attr(ctx context.Context, attr *fuse.Attr) error {\n+\tattr.Mode = os.ModeDir | 0555\n+\treturn nil\n+}\n+\n+func (r *root) getCachedMountpoint(uid uint32) string {\n+\tr.lock.RLock()\n+\tdefer r.lock.RUnlock()\n+\tentry, ok := r.mountpointCache[uid]\n+\tif !ok {\n+\t\treturn \"\"\n+\t}\n+\tnow := time.Now()\n+\tif now.Sub(entry.time) > mountpointTimeout {\n+\t\t// Don't bother deleting the entry, since the caller should\n+\t\t// just overwrite it.\n+\t\treturn \"\"\n+\t}\n+\treturn entry.mountpoint\n+}\n+\n+func (r *root) findKBFSMount(ctx context.Context) (\n+\tmountpoint string, err error) {\n+\tuid := ctx.Value(fs.CtxHeaderUIDKey).(uint32)\n+\t// Don't let the root see anything here; we don't want a symlink\n+\t// loop back to this mount.\n+\tif uid == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\n+\tmountpoint = r.getCachedMountpoint(uid)\n+\tif mountpoint != \"\" {\n+\t\treturn mountpoint, nil\n+\t}\n+\n+\tdefer func() {\n+\t\tif err != nil {\n+\t\t\treturn\n+\t\t}\n+\t\t// Cache the entry if we didn't hit an error.\n+\t\tr.lock.Lock()\n+\t\tdefer r.lock.Unlock()\n+\t\tr.mountpointCache[uid] = cacheEntry{\n+\t\t\tmountpoint: mountpoint,\n+\t\t\ttime:       time.Now(),\n+\t\t}\n+\t}()\n+\n+\tu, err := user.LookupId(strconv.FormatUint(uint64(uid), 10))\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\n+\tvols, err := gomounts.GetMountedVolumes()\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\tfuseType := \"fuse\"\n+\tif runtime.GOOS == \"darwin\" {\n+\t\tfuseType = \"kbfuse\"\n+\t}\n+\tvar fuseMountPoints []string\n+\tfor _, v := range vols {\n+\t\tif v.Type != fuseType {\n+\t\t\tcontinue\n+\t\t}\n+\t\tif v.Owner != u.Uid {\n+\t\t\tcontinue\n+\t\t}\n+\t\tfuseMountPoints = append(fuseMountPoints, v.Path)\n+\t}\n+\n+\tif len(fuseMountPoints) == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\tif len(fuseMountPoints) == 1 {\n+\t\treturn fuseMountPoints[0], nil\n+\t}\n+\n+\t// If there is more than one, pick the first one alphabetically\n+\t// that has \"keybase\" in the path.\n+\tsort.Strings(fuseMountPoints)\n+\tfor _, mp := range fuseMountPoints {\n+\t\t// TODO: a better regexp that will rule out keybase.staging if\n+\t\t// we're in prod mode, etc.\n+\t\tif !strings.Contains(mp, \"keybase\") {\n+\t\t\tcontinue\n+\t\t}\n+\t\t// Double-check that this is a real KBFS mount.\n+\t\tif _, err := os.Stat(filepath.Join(mp, \".kbfs_error\")); err != nil {\n+\t\t\tcontinue\n+\t\t}\n+\t\treturn mp, nil\n+\t}\n+\n+\t// Give up and return the first one.\n+\treturn fuseMountPoints[0], nil\n+}\n+\n+func (r *root) ReadDirAll(ctx context.Context) ([]fuse.Dirent, error) {\n+\t_, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\tif err == fuse.ENOENT {\n+\t\t\treturn []fuse.Dirent{}, nil\n+\t\t} else {\n+\t\t\treturn []fuse.Dirent{}, err\n+\t\t}\n+\t}\n+\n+\t// TODO: show the `kbfs.error.txt\" and \"kbfs.nologin.txt\" files if\n+\t// they exist?  As root, it is hard to figure out if they're\n+\t// there, though.\n+\treturn []fuse.Dirent{\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"private\",\n+\t\t},\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"public\",\n+\t\t},\n+\t\tfuse.Dirent{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"team\",\n+\t\t},\n+\t}, nil\n+}\n+\n+func (r *root) Lookup(\n+\tctx context.Context, req *fuse.LookupRequest, resp *fuse.LookupResponse) (\n+\tn fs.Node, err error) {\n+\tmountpoint, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\n+\tresp.EntryValid = 0\n+\tswitch req.Name {\n+\tcase \"private\", \"public\", \"team\", \".kbfs_error\", \".kbfs_metrics\",\n+\t\t\".kbfs_profiles\", \".kbfs_reset_caches\", \".kbfs_status\",\n+\t\t\"kbfs.error.txt\", \"kbfs.nologin.txt\", \".kbfs_enable_auto_journals\",\n+\t\t\".kbfs_disable_auto_journals\", \".kbfs_enable_block_prefetching\",\n+\t\t\".kbfs_disable_block_prefetching\", \".kbfs_enable_debug_server\",\n+\t\t\".kbfs_disable_debug_server\":\n+\t\treturn symlink{filepath.Join(mountpoint, req.Name)}, nil\n+\t}\n+\treturn nil, fuse.ENOENT\n+}\n+\n+func main() {\n+\tcurrUser, err := user.Current()\n+\tif err != nil {\n+\t\tpanic(err)\n+\t}\n+\tif currUser.Uid != \"0\" {\n+\t\truntime.LockOSThread()\n+\t\t_, _, errNo := syscall.Syscall(syscall.SYS_SETUID, 0, 0, 0)","path":"redirector/go/main.go","position":228,"original_position":229,"commit_id":"a375bbaa852f7c4c5475526da029481d313d80e8","original_commit_id":"4a9c54931293f10b5568f92acdec99a7e74547c5","user":{"login":"oconnor663","id":860932,"avatar_url":"https://avatars0.githubusercontent.com/u/860932?v=4","gravatar_id":"","url":"https://api.github.com/users/oconnor663","html_url":"https://github.com/oconnor663","followers_url":"https://api.github.com/users/oconnor663/followers","following_url":"https://api.github.com/users/oconnor663/following{/other_user}","gists_url":"https://api.github.com/users/oconnor663/gists{/gist_id}","starred_url":"https://api.github.com/users/oconnor663/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oconnor663/subscriptions","organizations_url":"https://api.github.com/users/oconnor663/orgs","repos_url":"https://api.github.com/users/oconnor663/repos","events_url":"https://api.github.com/users/oconnor663/events{/privacy}","received_events_url":"https://api.github.com/users/oconnor663/received_events","type":"User","site_admin":false},"body":"Another more trivial Go program seems to work just fine with the suid flag. (I just had it create a file in the current directory. Works in root-owned directories without `sudo`.)","created_at":"2018-02-28T21:47:43Z","updated_at":"2018-02-28T21:47:43Z","html_url":"https://github.com/keybase/kbfs/pull/1496#discussion_r171395921","pull_request_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171395921"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496#discussion_r171395921"},"pull_request":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"}},"in_reply_to_id":171385042},"pull_request":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","id":172070599,"html_url":"https://github.com/keybase/kbfs/pull/1496","diff_url":"https://github.com/keybase/kbfs/pull/1496.diff","patch_url":"https://github.com/keybase/kbfs/pull/1496.patch","issue_url":"https://api.github.com/repos/keybase/kbfs/issues/1496","number":1496,"state":"open","locked":false,"title":"redirector: a Go implementation for the root redirector","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"This implementation of the root redirector will likely be used for macOS, at least until we figure out the kbfuse+Rust situation.\r\n\r\nNote that I needed some new bazil.org/fuse options, so I forked it to github.comkeybase/fuse and added two new features:\r\n* A NoBrowse() option that keeps the redirector from showing up in the Finder (instead, the specific user's mount will show up).\r\n* Adding the requesting user's UID to the context for every request, since `ReadDirAll` needs to know whether the requesting user has a valid mountpoint or not.  The bazil.org/fuse interface for `ReadDirAll` doesn't pass this down, so putting it in the context seemed like the easiest option for now.\r\n\r\nIssue: KBFS-2774","created_at":"2018-02-28T20:58:07Z","updated_at":"2018-02-28T21:47:43Z","closed_at":null,"merged_at":null,"merge_commit_sha":"437c5c76f895a2fc4092ddecb665a8ea1424e823","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jzila","id":59594,"avatar_url":"https://avatars1.githubusercontent.com/u/59594?v=4","gravatar_id":"","url":"https://api.github.com/users/jzila","html_url":"https://github.com/jzila","followers_url":"https://api.github.com/users/jzila/followers","following_url":"https://api.github.com/users/jzila/following{/other_user}","gists_url":"https://api.github.com/users/jzila/gists{/gist_id}","starred_url":"https://api.github.com/users/jzila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzila/subscriptions","organizations_url":"https://api.github.com/users/jzila/orgs","repos_url":"https://api.github.com/users/jzila/repos","events_url":"https://api.github.com/users/jzila/events{/privacy}","received_events_url":"https://api.github.com/users/jzila/received_events","type":"User","site_admin":false},{"login":"songgao","id":255797,"avatar_url":"https://avatars3.githubusercontent.com/u/255797?v=4","gravatar_id":"","url":"https://api.github.com/users/songgao","html_url":"https://github.com/songgao","followers_url":"https://api.github.com/users/songgao/followers","following_url":"https://api.github.com/users/songgao/following{/other_user}","gists_url":"https://api.github.com/users/songgao/gists{/gist_id}","starred_url":"https://api.github.com/users/songgao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songgao/subscriptions","organizations_url":"https://api.github.com/users/songgao/orgs","repos_url":"https://api.github.com/users/songgao/repos","events_url":"https://api.github.com/users/songgao/events{/privacy}","received_events_url":"https://api.github.com/users/songgao/received_events","type":"User","site_admin":false},{"login":"akalin-keybase","id":13270622,"avatar_url":"https://avatars3.githubusercontent.com/u/13270622?v=4","gravatar_id":"","url":"https://api.github.com/users/akalin-keybase","html_url":"https://github.com/akalin-keybase","followers_url":"https://api.github.com/users/akalin-keybase/followers","following_url":"https://api.github.com/users/akalin-keybase/following{/other_user}","gists_url":"https://api.github.com/users/akalin-keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/akalin-keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akalin-keybase/subscriptions","organizations_url":"https://api.github.com/users/akalin-keybase/orgs","repos_url":"https://api.github.com/users/akalin-keybase/repos","events_url":"https://api.github.com/users/akalin-keybase/events{/privacy}","received_events_url":"https://api.github.com/users/akalin-keybase/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits","review_comments_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments","review_comment_url":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8","head":{"label":"keybase:strib/KBFS-2774-mount-redirector","ref":"strib/KBFS-2774-mount-redirector","sha":"a375bbaa852f7c4c5475526da029481d313d80e8","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"478a58b55a4605e2abe8699e32adc066bf1df7ee","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496"},"issue":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496"},"comments":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:47:43Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312669209","type":"CreateEvent","actor":{"id":866815,"login":"maxtaco","display_login":"maxtaco","gravatar_id":"","url":"https://api.github.com/users/maxtaco","avatar_url":"https://avatars.githubusercontent.com/u/866815?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"ref":"maxtaco/CORE-7305","ref_type":"branch","master_branch":"master","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","pusher_type":"user"},"public":true,"created_at":"2018-02-28T21:46:46Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312663913","type":"PullRequestEvent","actor":{"id":11968340,"login":"buoyad","display_login":"buoyad","gravatar_id":"","url":"https://api.github.com/users/buoyad","avatar_url":"https://avatars.githubusercontent.com/u/11968340?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"opened","number":10734,"pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10734","id":172081867,"html_url":"https://github.com/keybase/client/pull/10734","diff_url":"https://github.com/keybase/client/pull/10734.diff","patch_url":"https://github.com/keybase/client/pull/10734.patch","issue_url":"https://api.github.com/repos/keybase/client/issues/10734","number":10734,"state":"open","locked":false,"title":"Center role picker","user":{"login":"buoyad","id":11968340,"avatar_url":"https://avatars1.githubusercontent.com/u/11968340?v=4","gravatar_id":"","url":"https://api.github.com/users/buoyad","html_url":"https://github.com/buoyad","followers_url":"https://api.github.com/users/buoyad/followers","following_url":"https://api.github.com/users/buoyad/following{/other_user}","gists_url":"https://api.github.com/users/buoyad/gists{/gist_id}","starred_url":"https://api.github.com/users/buoyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/buoyad/subscriptions","organizations_url":"https://api.github.com/users/buoyad/orgs","repos_url":"https://api.github.com/users/buoyad/repos","events_url":"https://api.github.com/users/buoyad/events{/privacy}","received_events_url":"https://api.github.com/users/buoyad/received_events","type":"User","site_admin":false},"body":"Shuffles some styles to re-center the role picker on mobile.\r\n\r\n5S simulator:\r\n<img src=\"https://user-images.githubusercontent.com/11968340/36814782-9e474e60-1ca6-11e8-9dec-c00244a00143.png\" width=\"300px\" />\r\n\r\ndesktop:\r\n<img width=\"712\" alt=\"image\" src=\"https://user-images.githubusercontent.com/11968340/36814815-bba6db24-1ca6-11e8-9905-87e1b66e521f.png\">","created_at":"2018-02-28T21:45:38Z","updated_at":"2018-02-28T21:45:38Z","closed_at":null,"merged_at":null,"merge_commit_sha":null,"assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/client/pulls/10734/commits","review_comments_url":"https://api.github.com/repos/keybase/client/pulls/10734/comments","review_comment_url":"https://api.github.com/repos/keybase/client/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/client/issues/10734/comments","statuses_url":"https://api.github.com/repos/keybase/client/statuses/d05341d5db8c3013f116a592e101ea8be9482fcc","head":{"label":"keybase:danny/DESKTOP-6158/center-role-picker","ref":"danny/DESKTOP-6158/center-role-picker","sha":"d05341d5db8c3013f116a592e101ea8be9482fcc","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:44:20Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1894,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1894,"watchers":3297,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"c88f6f7e0a0780839f3010f61192856853f208cd","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T21:41:21Z","pushed_at":"2018-02-28T21:44:20Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3297,"watchers_count":3297,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1894,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1894,"watchers":3297,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/10734"},"html":{"href":"https://github.com/keybase/client/pull/10734"},"issue":{"href":"https://api.github.com/repos/keybase/client/issues/10734"},"comments":{"href":"https://api.github.com/repos/keybase/client/issues/10734/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/client/pulls/10734/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/client/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/client/pulls/10734/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/client/statuses/d05341d5db8c3013f116a592e101ea8be9482fcc"}},"author_association":"MEMBER","merged":false,"mergeable":null,"rebaseable":null,"mergeable_state":"unknown","merged_by":null,"comments":0,"review_comments":0,"maintainer_can_modify":false,"commits":1,"additions":6,"deletions":8,"changed_files":1}},"public":true,"created_at":"2018-02-28T21:45:39Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312657704","type":"PushEvent","actor":{"id":8516691,"login":"strib","display_login":"strib","gravatar_id":"","url":"https://api.github.com/users/strib","avatar_url":"https://avatars.githubusercontent.com/u/8516691?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366737434,"size":1,"distinct_size":1,"ref":"refs/heads/strib/KBFS-2798-turn-off-root-redirector","head":"4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b","before":"ee1dd39ef590e8a447ae2bf25d96e52d11c1d015","commits":[{"sha":"4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b","author":{"email":"strib@alum.mit.edu","name":"Jeremy Stribling"},"message":"packaging: use new keybase-redirector Go location\n\nIssue: KBFS-2774","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/4b3d51122c7209ce0d6b3f10f5d0cebd54b8a02b"}]},"public":true,"created_at":"2018-02-28T21:44:20Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312646812","type":"PullRequestReviewCommentEvent","actor":{"id":860932,"login":"oconnor663","display_login":"oconnor663","gravatar_id":"","url":"https://api.github.com/users/oconnor663","avatar_url":"https://avatars.githubusercontent.com/u/860932?"},"repo":{"id":59787605,"name":"keybase/kbfs","url":"https://api.github.com/repos/keybase/kbfs"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171394506","pull_request_review_id":100240041,"id":171394506,"diff_hunk":"@@ -0,0 +1,267 @@\n+// Copyright 2018 Keybase Inc. All rights reserved.\n+// Use of this source code is governed by a BSD\n+// license that can be found in the LICENSE file.\n+\n+package main\n+\n+import (\n+\t\"context\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"os/signal\"\n+\t\"os/user\"\n+\t\"path/filepath\"\n+\t\"runtime\"\n+\t\"sort\"\n+\t\"strconv\"\n+\t\"strings\"\n+\t\"sync\"\n+\t\"syscall\"\n+\t\"time\"\n+\n+\t\"bazil.org/fuse\"\n+\t\"bazil.org/fuse/fs\"\n+\t\"github.com/strib/gomounts\"\n+)\n+\n+var kbfusePath = fuse.OSXFUSEPaths{\n+\tDevicePrefix: \"/dev/kbfuse\",\n+\tLoad:         \"/Library/Filesystems/kbfuse.fs/Contents/Resources/load_kbfuse\",\n+\tMount:        \"/Library/Filesystems/kbfuse.fs/Contents/Resources/mount_kbfuse\",\n+\tDaemonVar:    \"MOUNT_KBFUSE_DAEMON_PATH\",\n+}\n+\n+const (\n+\tmountpointTimeout = 5 * time.Second\n+)\n+\n+type symlink struct {\n+\tlink string\n+}\n+\n+func (s symlink) Attr(ctx context.Context, a *fuse.Attr) (err error) {\n+\ta.Mode = os.ModeSymlink | a.Mode | 0555\n+\ta.Valid = 0\n+\treturn nil\n+}\n+\n+func (s symlink) Readlink(ctx context.Context, req *fuse.ReadlinkRequest) (\n+\tlink string, err error) {\n+\treturn s.link, nil\n+}\n+\n+type cacheEntry struct {\n+\tmountpoint string\n+\ttime       time.Time\n+}\n+\n+type root struct {\n+\tlock            sync.RWMutex\n+\tmountpointCache map[uint32]cacheEntry\n+}\n+\n+func newRoot() *root {\n+\treturn &root{\n+\t\tmountpointCache: make(map[uint32]cacheEntry),\n+\t}\n+}\n+\n+func (r *root) Root() (fs.Node, error) {\n+\treturn r, nil\n+}\n+\n+func (r *root) Attr(ctx context.Context, attr *fuse.Attr) error {\n+\tattr.Mode = os.ModeDir | 0555\n+\treturn nil\n+}\n+\n+func (r *root) getCachedMountpoint(uid uint32) string {\n+\tr.lock.RLock()\n+\tdefer r.lock.RUnlock()\n+\tentry, ok := r.mountpointCache[uid]\n+\tif !ok {\n+\t\treturn \"\"\n+\t}\n+\tnow := time.Now()\n+\tif now.Sub(entry.time) > mountpointTimeout {\n+\t\t// Don't bother deleting the entry, since the caller should\n+\t\t// just overwrite it.\n+\t\treturn \"\"\n+\t}\n+\treturn entry.mountpoint\n+}\n+\n+func (r *root) findKBFSMount(ctx context.Context) (\n+\tmountpoint string, err error) {\n+\tuid := ctx.Value(fs.CtxHeaderUIDKey).(uint32)\n+\t// Don't let the root see anything here; we don't want a symlink\n+\t// loop back to this mount.\n+\tif uid == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\n+\tmountpoint = r.getCachedMountpoint(uid)\n+\tif mountpoint != \"\" {\n+\t\treturn mountpoint, nil\n+\t}\n+\n+\tdefer func() {\n+\t\tif err != nil {\n+\t\t\treturn\n+\t\t}\n+\t\t// Cache the entry if we didn't hit an error.\n+\t\tr.lock.Lock()\n+\t\tdefer r.lock.Unlock()\n+\t\tr.mountpointCache[uid] = cacheEntry{\n+\t\t\tmountpoint: mountpoint,\n+\t\t\ttime:       time.Now(),\n+\t\t}\n+\t}()\n+\n+\tu, err := user.LookupId(strconv.FormatUint(uint64(uid), 10))\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\n+\tvols, err := gomounts.GetMountedVolumes()\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\tfuseType := \"fuse\"\n+\tif runtime.GOOS == \"darwin\" {\n+\t\tfuseType = \"kbfuse\"\n+\t}\n+\tvar fuseMountPoints []string\n+\tfor _, v := range vols {\n+\t\tif v.Type != fuseType {\n+\t\t\tcontinue\n+\t\t}\n+\t\tif v.Owner != u.Uid {\n+\t\t\tcontinue\n+\t\t}\n+\t\tfuseMountPoints = append(fuseMountPoints, v.Path)\n+\t}\n+\n+\tif len(fuseMountPoints) == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\tif len(fuseMountPoints) == 1 {\n+\t\treturn fuseMountPoints[0], nil\n+\t}\n+\n+\t// If there is more than one, pick the first one alphabetically\n+\t// that has \"keybase\" in the path.\n+\tsort.Strings(fuseMountPoints)\n+\tfor _, mp := range fuseMountPoints {\n+\t\t// TODO: a better regexp that will rule out keybase.staging if\n+\t\t// we're in prod mode, etc.\n+\t\tif !strings.Contains(mp, \"keybase\") {\n+\t\t\tcontinue\n+\t\t}\n+\t\t// Double-check that this is a real KBFS mount.\n+\t\tif _, err := os.Stat(filepath.Join(mp, \".kbfs_error\")); err != nil {\n+\t\t\tcontinue\n+\t\t}\n+\t\treturn mp, nil\n+\t}\n+\n+\t// Give up and return the first one.\n+\treturn fuseMountPoints[0], nil\n+}\n+\n+func (r *root) ReadDirAll(ctx context.Context) ([]fuse.Dirent, error) {\n+\t_, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\tif err == fuse.ENOENT {\n+\t\t\treturn []fuse.Dirent{}, nil\n+\t\t} else {\n+\t\t\treturn []fuse.Dirent{}, err\n+\t\t}\n+\t}\n+\n+\t// TODO: show the `kbfs.error.txt\" and \"kbfs.nologin.txt\" files if\n+\t// they exist?  As root, it is hard to figure out if they're\n+\t// there, though.\n+\treturn []fuse.Dirent{\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"private\",\n+\t\t},\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"public\",\n+\t\t},\n+\t\tfuse.Dirent{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"team\",\n+\t\t},\n+\t}, nil\n+}\n+\n+func (r *root) Lookup(\n+\tctx context.Context, req *fuse.LookupRequest, resp *fuse.LookupResponse) (\n+\tn fs.Node, err error) {\n+\tmountpoint, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\n+\tresp.EntryValid = 0\n+\tswitch req.Name {\n+\tcase \"private\", \"public\", \"team\", \".kbfs_error\", \".kbfs_metrics\",\n+\t\t\".kbfs_profiles\", \".kbfs_reset_caches\", \".kbfs_status\",\n+\t\t\"kbfs.error.txt\", \"kbfs.nologin.txt\", \".kbfs_enable_auto_journals\",\n+\t\t\".kbfs_disable_auto_journals\", \".kbfs_enable_block_prefetching\",\n+\t\t\".kbfs_disable_block_prefetching\", \".kbfs_enable_debug_server\",\n+\t\t\".kbfs_disable_debug_server\":\n+\t\treturn symlink{filepath.Join(mountpoint, req.Name)}, nil\n+\t}\n+\treturn nil, fuse.ENOENT\n+}\n+\n+func main() {\n+\tcurrUser, err := user.Current()\n+\tif err != nil {\n+\t\tpanic(err)\n+\t}\n+\tif currUser.Uid != \"0\" {\n+\t\truntime.LockOSThread()\n+\t\t_, _, errNo := syscall.Syscall(syscall.SYS_SETUID, 0, 0, 0)","path":"redirector/go/main.go","position":228,"original_position":229,"commit_id":"a375bbaa852f7c4c5475526da029481d313d80e8","original_commit_id":"4a9c54931293f10b5568f92acdec99a7e74547c5","user":{"login":"oconnor663","id":860932,"avatar_url":"https://avatars0.githubusercontent.com/u/860932?v=4","gravatar_id":"","url":"https://api.github.com/users/oconnor663","html_url":"https://github.com/oconnor663","followers_url":"https://api.github.com/users/oconnor663/followers","following_url":"https://api.github.com/users/oconnor663/following{/other_user}","gists_url":"https://api.github.com/users/oconnor663/gists{/gist_id}","starred_url":"https://api.github.com/users/oconnor663/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oconnor663/subscriptions","organizations_url":"https://api.github.com/users/oconnor663/orgs","repos_url":"https://api.github.com/users/oconnor663/repos","events_url":"https://api.github.com/users/oconnor663/events{/privacy}","received_events_url":"https://api.github.com/users/oconnor663/received_events","type":"User","site_admin":false},"body":"Oof, why does this work with a Rust binary but not a Go binary? I just rechecked that it does. (I wasn't able to use `/tmp` for everything though, because it's a `nosuid` mount on my system. Hopefully that doesn't matter here.)","created_at":"2018-02-28T21:42:05Z","updated_at":"2018-02-28T21:42:05Z","html_url":"https://github.com/keybase/kbfs/pull/1496#discussion_r171394506","pull_request_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171394506"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496#discussion_r171394506"},"pull_request":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"}},"in_reply_to_id":171385042},"pull_request":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","id":172070599,"html_url":"https://github.com/keybase/kbfs/pull/1496","diff_url":"https://github.com/keybase/kbfs/pull/1496.diff","patch_url":"https://github.com/keybase/kbfs/pull/1496.patch","issue_url":"https://api.github.com/repos/keybase/kbfs/issues/1496","number":1496,"state":"open","locked":false,"title":"redirector: a Go implementation for the root redirector","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"This implementation of the root redirector will likely be used for macOS, at least until we figure out the kbfuse+Rust situation.\r\n\r\nNote that I needed some new bazil.org/fuse options, so I forked it to github.comkeybase/fuse and added two new features:\r\n* A NoBrowse() option that keeps the redirector from showing up in the Finder (instead, the specific user's mount will show up).\r\n* Adding the requesting user's UID to the context for every request, since `ReadDirAll` needs to know whether the requesting user has a valid mountpoint or not.  The bazil.org/fuse interface for `ReadDirAll` doesn't pass this down, so putting it in the context seemed like the easiest option for now.\r\n\r\nIssue: KBFS-2774","created_at":"2018-02-28T20:58:07Z","updated_at":"2018-02-28T21:42:05Z","closed_at":null,"merged_at":null,"merge_commit_sha":"437c5c76f895a2fc4092ddecb665a8ea1424e823","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jzila","id":59594,"avatar_url":"https://avatars1.githubusercontent.com/u/59594?v=4","gravatar_id":"","url":"https://api.github.com/users/jzila","html_url":"https://github.com/jzila","followers_url":"https://api.github.com/users/jzila/followers","following_url":"https://api.github.com/users/jzila/following{/other_user}","gists_url":"https://api.github.com/users/jzila/gists{/gist_id}","starred_url":"https://api.github.com/users/jzila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzila/subscriptions","organizations_url":"https://api.github.com/users/jzila/orgs","repos_url":"https://api.github.com/users/jzila/repos","events_url":"https://api.github.com/users/jzila/events{/privacy}","received_events_url":"https://api.github.com/users/jzila/received_events","type":"User","site_admin":false},{"login":"songgao","id":255797,"avatar_url":"https://avatars3.githubusercontent.com/u/255797?v=4","gravatar_id":"","url":"https://api.github.com/users/songgao","html_url":"https://github.com/songgao","followers_url":"https://api.github.com/users/songgao/followers","following_url":"https://api.github.com/users/songgao/following{/other_user}","gists_url":"https://api.github.com/users/songgao/gists{/gist_id}","starred_url":"https://api.github.com/users/songgao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songgao/subscriptions","organizations_url":"https://api.github.com/users/songgao/orgs","repos_url":"https://api.github.com/users/songgao/repos","events_url":"https://api.github.com/users/songgao/events{/privacy}","received_events_url":"https://api.github.com/users/songgao/received_events","type":"User","site_admin":false},{"login":"akalin-keybase","id":13270622,"avatar_url":"https://avatars3.githubusercontent.com/u/13270622?v=4","gravatar_id":"","url":"https://api.github.com/users/akalin-keybase","html_url":"https://github.com/akalin-keybase","followers_url":"https://api.github.com/users/akalin-keybase/followers","following_url":"https://api.github.com/users/akalin-keybase/following{/other_user}","gists_url":"https://api.github.com/users/akalin-keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/akalin-keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akalin-keybase/subscriptions","organizations_url":"https://api.github.com/users/akalin-keybase/orgs","repos_url":"https://api.github.com/users/akalin-keybase/repos","events_url":"https://api.github.com/users/akalin-keybase/events{/privacy}","received_events_url":"https://api.github.com/users/akalin-keybase/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits","review_comments_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments","review_comment_url":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8","head":{"label":"keybase:strib/KBFS-2774-mount-redirector","ref":"strib/KBFS-2774-mount-redirector","sha":"a375bbaa852f7c4c5475526da029481d313d80e8","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"478a58b55a4605e2abe8699e32adc066bf1df7ee","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496"},"issue":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496"},"comments":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:42:05Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312643297","type":"CreateEvent","actor":{"id":11968340,"login":"buoyad","display_login":"buoyad","gravatar_id":"","url":"https://api.github.com/users/buoyad","avatar_url":"https://avatars.githubusercontent.com/u/11968340?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"ref":"danny/DESKTOP-6158/center-role-picker","ref_type":"branch","master_branch":"master","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","pusher_type":"user"},"public":true,"created_at":"2018-02-28T21:41:21Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312643269","type":"WatchEvent","actor":{"id":26855518,"login":"fr0g96","display_login":"fr0g96","gravatar_id":"","url":"https://api.github.com/users/fr0g96","avatar_url":"https://avatars.githubusercontent.com/u/26855518?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"started"},"public":true,"created_at":"2018-02-28T21:41:21Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312637689","type":"IssueCommentEvent","actor":{"id":2508,"login":"patrickxb","display_login":"patrickxb","gravatar_id":"","url":"https://api.github.com/users/patrickxb","avatar_url":"https://avatars.githubusercontent.com/u/2508?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/keybase/client/issues/10651","repository_url":"https://api.github.com/repos/keybase/client","labels_url":"https://api.github.com/repos/keybase/client/issues/10651/labels{/name}","comments_url":"https://api.github.com/repos/keybase/client/issues/10651/comments","events_url":"https://api.github.com/repos/keybase/client/issues/10651/events","html_url":"https://github.com/keybase/client/pull/10651","id":299199852,"number":10651,"title":"Bundle any existing trace files during a log send","user":{"login":"akalin-keybase","id":13270622,"avatar_url":"https://avatars3.githubusercontent.com/u/13270622?v=4","gravatar_id":"","url":"https://api.github.com/users/akalin-keybase","html_url":"https://github.com/akalin-keybase","followers_url":"https://api.github.com/users/akalin-keybase/followers","following_url":"https://api.github.com/users/akalin-keybase/following{/other_user}","gists_url":"https://api.github.com/users/akalin-keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/akalin-keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akalin-keybase/subscriptions","organizations_url":"https://api.github.com/users/akalin-keybase/orgs","repos_url":"https://api.github.com/users/akalin-keybase/repos","events_url":"https://api.github.com/users/akalin-keybase/events{/privacy}","received_events_url":"https://api.github.com/users/akalin-keybase/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-02-22T02:21:35Z","updated_at":"2018-02-28T21:40:13Z","closed_at":null,"author_association":"CONTRIBUTOR","pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10651","html_url":"https://github.com/keybase/client/pull/10651","diff_url":"https://github.com/keybase/client/pull/10651.diff","patch_url":"https://github.com/keybase/client/pull/10651.patch"},"body":"Put it in a single .tar.gz to upload to the server."},"comment":{"url":"https://api.github.com/repos/keybase/client/issues/comments/369392416","html_url":"https://github.com/keybase/client/pull/10651#issuecomment-369392416","issue_url":"https://api.github.com/repos/keybase/client/issues/10651","id":369392416,"user":{"login":"patrickxb","id":2508,"avatar_url":"https://avatars2.githubusercontent.com/u/2508?v=4","gravatar_id":"","url":"https://api.github.com/users/patrickxb","html_url":"https://github.com/patrickxb","followers_url":"https://api.github.com/users/patrickxb/followers","following_url":"https://api.github.com/users/patrickxb/following{/other_user}","gists_url":"https://api.github.com/users/patrickxb/gists{/gist_id}","starred_url":"https://api.github.com/users/patrickxb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patrickxb/subscriptions","organizations_url":"https://api.github.com/users/patrickxb/orgs","repos_url":"https://api.github.com/users/patrickxb/repos","events_url":"https://api.github.com/users/patrickxb/events{/privacy}","received_events_url":"https://api.github.com/users/patrickxb/received_events","type":"User","site_admin":false},"created_at":"2018-02-28T21:40:13Z","updated_at":"2018-02-28T21:40:13Z","author_association":"CONTRIBUTOR","body":"I'm still concerned about users sending in potentially sensitive data.\r\n\r\nIf the button to generate a trace file is now hidden and only admins will use it, it seems fine to get the trace files off via usb during performance testing.\r\n\r\n@cjb i'm curious what you think.\r\n"}},"public":true,"created_at":"2018-02-28T21:40:13Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312584333","type":"PullRequestReviewCommentEvent","actor":{"id":1144020,"login":"joshblum","display_login":"joshblum","gravatar_id":"","url":"https://api.github.com/users/joshblum","avatar_url":"https://avatars.githubusercontent.com/u/1144020?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/client/pulls/comments/171391102","pull_request_review_id":100235897,"id":171391102,"diff_hunk":"@@ -16,15 +16,10 @@ const (\n )\n \n func TestBackgroundIdentifier(t *testing.T) {\n-\tdoWithSigChainVersions(func(sigVersion libkb.SigVersion) {\n-\t\t_testBackgroundIdentifier(t, sigVersion)\n-\t})\n-}\n-\n-func _testBackgroundIdentifier(t *testing.T, sigVersion libkb.SigVersion) {\n \tt.Skip()\n \ttc := SetupEngineTest(t, \"track\")\n \tdefer tc.Cleanup()\n+\tsigVersion := libkb.GetDefaultSigVersion(tc.G)","path":"go/engine/bg_identifier_test.go","position":13,"original_position":13,"commit_id":"63dd23b0a7c79a1e6e9b10b15180e388ec3e696d","original_commit_id":"63dd23b0a7c79a1e6e9b10b15180e388ec3e696d","user":{"login":"joshblum","id":1144020,"avatar_url":"https://avatars0.githubusercontent.com/u/1144020?v=4","gravatar_id":"","url":"https://api.github.com/users/joshblum","html_url":"https://github.com/joshblum","followers_url":"https://api.github.com/users/joshblum/followers","following_url":"https://api.github.com/users/joshblum/following{/other_user}","gists_url":"https://api.github.com/users/joshblum/gists{/gist_id}","starred_url":"https://api.github.com/users/joshblum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshblum/subscriptions","organizations_url":"https://api.github.com/users/joshblum/orgs","repos_url":"https://api.github.com/users/joshblum/repos","events_url":"https://api.github.com/users/joshblum/events{/privacy}","received_events_url":"https://api.github.com/users/joshblum/received_events","type":"User","site_admin":false},"body":"note: currently this returns V1 unless you're feature flagged as admin ","created_at":"2018-02-28T21:29:36Z","updated_at":"2018-02-28T21:29:36Z","html_url":"https://github.com/keybase/client/pull/10733#discussion_r171391102","pull_request_url":"https://api.github.com/repos/keybase/client/pulls/10733","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/comments/171391102"},"html":{"href":"https://github.com/keybase/client/pull/10733#discussion_r171391102"},"pull_request":{"href":"https://api.github.com/repos/keybase/client/pulls/10733"}}},"pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10733","id":172077805,"html_url":"https://github.com/keybase/client/pull/10733","diff_url":"https://github.com/keybase/client/pull/10733.diff","patch_url":"https://github.com/keybase/client/pull/10733.patch","issue_url":"https://api.github.com/repos/keybase/client/issues/10733","number":10733,"state":"open","locked":false,"title":"Reduce testing time for sigchain related actions","user":{"login":"joshblum","id":1144020,"avatar_url":"https://avatars0.githubusercontent.com/u/1144020?v=4","gravatar_id":"","url":"https://api.github.com/users/joshblum","html_url":"https://github.com/joshblum","followers_url":"https://api.github.com/users/joshblum/followers","following_url":"https://api.github.com/users/joshblum/following{/other_user}","gists_url":"https://api.github.com/users/joshblum/gists{/gist_id}","starred_url":"https://api.github.com/users/joshblum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshblum/subscriptions","organizations_url":"https://api.github.com/users/joshblum/orgs","repos_url":"https://api.github.com/users/joshblum/repos","events_url":"https://api.github.com/users/joshblum/events{/privacy}","received_events_url":"https://api.github.com/users/joshblum/received_events","type":"User","site_admin":false},"body":"With the introduction of sigchain v2 we initially chained all sig chain related tests to test against both versions. This isn't necessary for tests where the sigchain action isn't the primary focus of the test so we try to remove the double testing in places it seemed redundant. \r\n\r\nStarting runtime:\r\n```\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     406.909s\r\n```\r\n\r\nOnly V1:\r\n```\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     327.448s\r\n```\r\n\r\n```\r\nOnly V2:\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     311.891s\r\n```\r\n\r\nAfter cherrypicking:\r\n```\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     335.090s\r\n```\r\n\r\ncc @mmaxim","created_at":"2018-02-28T21:28:39Z","updated_at":"2018-02-28T21:29:36Z","closed_at":null,"merged_at":null,"merge_commit_sha":"269749429661700aa362468b616b3f7b331d727e","assignee":null,"assignees":[],"requested_reviewers":[{"login":"maxtaco","id":866815,"avatar_url":"https://avatars0.githubusercontent.com/u/866815?v=4","gravatar_id":"","url":"https://api.github.com/users/maxtaco","html_url":"https://github.com/maxtaco","followers_url":"https://api.github.com/users/maxtaco/followers","following_url":"https://api.github.com/users/maxtaco/following{/other_user}","gists_url":"https://api.github.com/users/maxtaco/gists{/gist_id}","starred_url":"https://api.github.com/users/maxtaco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxtaco/subscriptions","organizations_url":"https://api.github.com/users/maxtaco/orgs","repos_url":"https://api.github.com/users/maxtaco/repos","events_url":"https://api.github.com/users/maxtaco/events{/privacy}","received_events_url":"https://api.github.com/users/maxtaco/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/client/pulls/10733/commits","review_comments_url":"https://api.github.com/repos/keybase/client/pulls/10733/comments","review_comment_url":"https://api.github.com/repos/keybase/client/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/client/issues/10733/comments","statuses_url":"https://api.github.com/repos/keybase/client/statuses/63dd23b0a7c79a1e6e9b10b15180e388ec3e696d","head":{"label":"keybase:joshblum/CORE-7313-sigchain-tests","ref":"joshblum/CORE-7313-sigchain-tests","sha":"63dd23b0a7c79a1e6e9b10b15180e388ec3e696d","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T15:16:50Z","pushed_at":"2018-02-28T21:28:39Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3296,"watchers_count":3296,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1893,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1893,"watchers":3296,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"c88f6f7e0a0780839f3010f61192856853f208cd","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T15:16:50Z","pushed_at":"2018-02-28T21:28:39Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3296,"watchers_count":3296,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1893,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1893,"watchers":3296,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/10733"},"html":{"href":"https://github.com/keybase/client/pull/10733"},"issue":{"href":"https://api.github.com/repos/keybase/client/issues/10733"},"comments":{"href":"https://api.github.com/repos/keybase/client/issues/10733/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/client/pulls/10733/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/client/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/client/pulls/10733/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/client/statuses/63dd23b0a7c79a1e6e9b10b15180e388ec3e696d"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:29:36Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312579518","type":"PullRequestEvent","actor":{"id":1144020,"login":"joshblum","display_login":"joshblum","gravatar_id":"","url":"https://api.github.com/users/joshblum","avatar_url":"https://avatars.githubusercontent.com/u/1144020?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"opened","number":10733,"pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10733","id":172077805,"html_url":"https://github.com/keybase/client/pull/10733","diff_url":"https://github.com/keybase/client/pull/10733.diff","patch_url":"https://github.com/keybase/client/pull/10733.patch","issue_url":"https://api.github.com/repos/keybase/client/issues/10733","number":10733,"state":"open","locked":false,"title":"Reduce testing time for sigchain related actions","user":{"login":"joshblum","id":1144020,"avatar_url":"https://avatars0.githubusercontent.com/u/1144020?v=4","gravatar_id":"","url":"https://api.github.com/users/joshblum","html_url":"https://github.com/joshblum","followers_url":"https://api.github.com/users/joshblum/followers","following_url":"https://api.github.com/users/joshblum/following{/other_user}","gists_url":"https://api.github.com/users/joshblum/gists{/gist_id}","starred_url":"https://api.github.com/users/joshblum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshblum/subscriptions","organizations_url":"https://api.github.com/users/joshblum/orgs","repos_url":"https://api.github.com/users/joshblum/repos","events_url":"https://api.github.com/users/joshblum/events{/privacy}","received_events_url":"https://api.github.com/users/joshblum/received_events","type":"User","site_admin":false},"body":"With the introduction of sigchain v2 we initially chained all sig chain related tests to test against both versions. This isn't necessary for tests where the sigchain action isn't the primary focus of the test so we try to remove the double testing in places it seemed redundant. \r\n\r\nStarting runtime:\r\n```\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     406.909s\r\n```\r\n\r\nOnly V1:\r\n```\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     327.448s\r\n```\r\n\r\n```\r\nOnly V2:\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     311.891s\r\n```\r\n\r\nAfter cherrypicking:\r\n```\r\n$ go test\r\nPASS\r\nok      github.com/keybase/client/go/engine     335.090s\r\n```\r\n\r\ncc @mmaxim","created_at":"2018-02-28T21:28:39Z","updated_at":"2018-02-28T21:29:36Z","closed_at":null,"merged_at":null,"merge_commit_sha":"269749429661700aa362468b616b3f7b331d727e","assignee":null,"assignees":[],"requested_reviewers":[{"login":"maxtaco","id":866815,"avatar_url":"https://avatars0.githubusercontent.com/u/866815?v=4","gravatar_id":"","url":"https://api.github.com/users/maxtaco","html_url":"https://github.com/maxtaco","followers_url":"https://api.github.com/users/maxtaco/followers","following_url":"https://api.github.com/users/maxtaco/following{/other_user}","gists_url":"https://api.github.com/users/maxtaco/gists{/gist_id}","starred_url":"https://api.github.com/users/maxtaco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxtaco/subscriptions","organizations_url":"https://api.github.com/users/maxtaco/orgs","repos_url":"https://api.github.com/users/maxtaco/repos","events_url":"https://api.github.com/users/maxtaco/events{/privacy}","received_events_url":"https://api.github.com/users/maxtaco/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/client/pulls/10733/commits","review_comments_url":"https://api.github.com/repos/keybase/client/pulls/10733/comments","review_comment_url":"https://api.github.com/repos/keybase/client/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/client/issues/10733/comments","statuses_url":"https://api.github.com/repos/keybase/client/statuses/63dd23b0a7c79a1e6e9b10b15180e388ec3e696d","head":{"label":"keybase:joshblum/CORE-7313-sigchain-tests","ref":"joshblum/CORE-7313-sigchain-tests","sha":"63dd23b0a7c79a1e6e9b10b15180e388ec3e696d","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T15:16:50Z","pushed_at":"2018-02-28T21:28:39Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3296,"watchers_count":3296,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1893,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1893,"watchers":3296,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"c88f6f7e0a0780839f3010f61192856853f208cd","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T15:16:50Z","pushed_at":"2018-02-28T21:28:39Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3296,"watchers_count":3296,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1893,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1893,"watchers":3296,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/10733"},"html":{"href":"https://github.com/keybase/client/pull/10733"},"issue":{"href":"https://api.github.com/repos/keybase/client/issues/10733"},"comments":{"href":"https://api.github.com/repos/keybase/client/issues/10733/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/client/pulls/10733/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/client/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/client/pulls/10733/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/client/statuses/63dd23b0a7c79a1e6e9b10b15180e388ec3e696d"}},"author_association":"CONTRIBUTOR","merged":false,"mergeable":true,"rebaseable":true,"mergeable_state":"unstable","merged_by":null,"comments":0,"review_comments":1,"maintainer_can_modify":false,"commits":1,"additions":50,"deletions":233,"changed_files":16}},"public":true,"created_at":"2018-02-28T21:30:01Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312563694","type":"CreateEvent","actor":{"id":1144020,"login":"joshblum","display_login":"joshblum","gravatar_id":"","url":"https://api.github.com/users/joshblum","avatar_url":"https://avatars.githubusercontent.com/u/1144020?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"ref":"joshblum/CORE-7313-sigchain-tests","ref_type":"branch","master_branch":"master","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","pusher_type":"user"},"public":true,"created_at":"2018-02-28T21:27:35Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312540099","type":"PushEvent","actor":{"id":862397,"login":"zanderz","display_login":"zanderz","gravatar_id":"","url":"https://api.github.com/users/zanderz","avatar_url":"https://avatars.githubusercontent.com/u/862397?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366677906,"size":1,"distinct_size":1,"ref":"refs/heads/zanderz/installer_2018.02.25","head":"959a9f00cbdd7cd9eee4744d6aac73cd04c7ff6c","before":"ddf877c44794dd0302dec47379531865e79f63e7","commits":[{"sha":"959a9f00cbdd7cd9eee4744d6aac73cd04c7ff6c","author":{"email":"steve@keyba.se","name":"Steve Sanders"},"message":"log file updload tweaking","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/959a9f00cbdd7cd9eee4744d6aac73cd04c7ff6c"}]},"public":true,"created_at":"2018-02-28T21:22:19Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312537288","type":"PullRequestReviewCommentEvent","actor":{"id":860932,"login":"oconnor663","display_login":"oconnor663","gravatar_id":"","url":"https://api.github.com/users/oconnor663","avatar_url":"https://avatars.githubusercontent.com/u/860932?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/client/pulls/comments/171388549","pull_request_review_id":100232921,"id":171388549,"diff_hunk":"@@ -0,0 +1,147 @@\n+package libkb\n+\n+import (\n+\tsha512 \"crypto/sha512\"\n+\tjson \"encoding/json\"\n+\tfmt \"fmt\"\n+\tkeybase1 \"github.com/keybase/client/go/protocol/keybase1\"\n+\tjsonw \"github.com/keybase/go-jsonw\"\n+\tcontext \"golang.org/x/net/context\"\n+)\n+\n+type resetLinkAndHash struct {\n+\tlink keybase1.ResetLink\n+\thash keybase1.SHA512\n+}\n+\n+type unverifiedResetChain []resetLinkAndHash\n+\n+func importResetLinkAndHash(s string) (ret *resetLinkAndHash, err error) {\n+\tb := []byte(s)\n+\thash := sha512.Sum512(b)\n+\tvar link keybase1.ResetLink\n+\terr = json.Unmarshal(b, &link)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\tret = &resetLinkAndHash{\n+\t\thash: hash[:],\n+\t\tlink: link,\n+\t}\n+\treturn ret, nil\n+}\n+\n+func importResetChainFromServer(ctx context.Context, g *GlobalContext, jw *jsonw.Wrapper) (urc unverifiedResetChain, err error) {\n+\tdefer g.CVTrace(ctx, VLog0, \"importResetChainFromServer\", func() error { return err })()\n+\tif jw == nil || jw.IsNil() {\n+\t\treturn nil, nil\n+\t}\n+\tvar ret unverifiedResetChain\n+\tchainLen, err := jw.Len()\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\tfor i := 0; i < chainLen; i++ {\n+\t\ts, err := jw.AtIndex(i).GetString()\n+\t\tif err != nil {\n+\t\t\treturn nil, err\n+\t\t}\n+\t\tlink, err := importResetLinkAndHash(s)\n+\t\tif err != nil {\n+\t\t\treturn nil, err\n+\t\t}\n+\t\tret = append(ret, *link)\n+\t}\n+\treturn ret, nil\n+}\n+\n+func parseV2LeafResetChainTail(jw *jsonw.Wrapper) (*MerkleResets, error) {\n+\tif jw == nil || jw.IsNil() {\n+\t\treturn nil, nil\n+\t}\n+\tl, err := jw.Len()\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\tif l == 0 {\n+\t\treturn nil, nil\n+\t}\n+\tif l != 2 {\n+\t\treturn nil, MerkleClientError{m: \"bad reset chain tail; expecting 2 items\", t: merkleErrorBadResetChain}\n+\t}\n+\tvar ct MerkleResetChainTail\n+\tif err := jw.AtIndex(0).UnmarshalAgain(&ct.Seqno); err != nil {\n+\t\treturn nil, err\n+\t}\n+\tif err := jw.AtIndex(1).UnmarshalAgain(&ct.Hash); err != nil {\n+\t\treturn nil, err\n+\t}\n+\tret := &MerkleResets{chainTail: ct}\n+\treturn ret, nil\n+}\n+\n+type MerkleResetChainTail struct {\n+\tSeqno keybase1.Seqno\n+\tHash  keybase1.SHA512\n+}\n+\n+type MerkleResets struct {\n+\tchainTail MerkleResetChainTail\n+\tchain     []keybase1.ResetLink\n+}\n+\n+func (mr *MerkleResets) verifyAndLoad(ctx context.Context, g *GlobalContext, urc unverifiedResetChain) (err error) {\n+\n+\t// Don't even both a trace if the user hasn't reset at all","path":"go/libkb/merkle_reset_chain.go","position":95,"original_position":95,"commit_id":"4a365bba8092b075cb01315d60277b97abb4b354","original_commit_id":"4a365bba8092b075cb01315d60277b97abb4b354","user":{"login":"oconnor663","id":860932,"avatar_url":"https://avatars0.githubusercontent.com/u/860932?v=4","gravatar_id":"","url":"https://api.github.com/users/oconnor663","html_url":"https://github.com/oconnor663","followers_url":"https://api.github.com/users/oconnor663/followers","following_url":"https://api.github.com/users/oconnor663/following{/other_user}","gists_url":"https://api.github.com/users/oconnor663/gists{/gist_id}","starred_url":"https://api.github.com/users/oconnor663/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oconnor663/subscriptions","organizations_url":"https://api.github.com/users/oconnor663/orgs","repos_url":"https://api.github.com/users/oconnor663/repos","events_url":"https://api.github.com/users/oconnor663/events{/privacy}","received_events_url":"https://api.github.com/users/oconnor663/received_events","type":"User","site_admin":false},"body":"Some typo here.","created_at":"2018-02-28T21:20:12Z","updated_at":"2018-02-28T21:20:12Z","html_url":"https://github.com/keybase/client/pull/10726#discussion_r171388549","pull_request_url":"https://api.github.com/repos/keybase/client/pulls/10726","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/comments/171388549"},"html":{"href":"https://github.com/keybase/client/pull/10726#discussion_r171388549"},"pull_request":{"href":"https://api.github.com/repos/keybase/client/pulls/10726"}}},"pull_request":{"url":"https://api.github.com/repos/keybase/client/pulls/10726","id":171965169,"html_url":"https://github.com/keybase/client/pull/10726","diff_url":"https://github.com/keybase/client/pull/10726.diff","patch_url":"https://github.com/keybase/client/pull/10726.patch","issue_url":"https://api.github.com/repos/keybase/client/issues/10726","number":10726,"state":"open","locked":false,"title":"Digest merkle reset chain; expose in UPAK2","user":{"login":"maxtaco","id":866815,"avatar_url":"https://avatars0.githubusercontent.com/u/866815?v=4","gravatar_id":"","url":"https://api.github.com/users/maxtaco","html_url":"https://github.com/maxtaco","followers_url":"https://api.github.com/users/maxtaco/followers","following_url":"https://api.github.com/users/maxtaco/following{/other_user}","gists_url":"https://api.github.com/users/maxtaco/gists{/gist_id}","starred_url":"https://api.github.com/users/maxtaco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxtaco/subscriptions","organizations_url":"https://api.github.com/users/maxtaco/orgs","repos_url":"https://api.github.com/users/maxtaco/repos","events_url":"https://api.github.com/users/maxtaco/events{/privacy}","received_events_url":"https://api.github.com/users/maxtaco/received_events","type":"User","site_admin":false},"body":"- plumb resets and verification of the reset chain through the merkle client\r\n- this requires a minor UPK bump for UPAK minor version <= 5, if there is a reset.\r\n- if no reset, and UPAK minor version 5, then we can stick with it\r\n- piggy-back testing on an existing test: TestExportAllIncarnationsAfterReset","created_at":"2018-02-28T14:16:07Z","updated_at":"2018-02-28T21:20:12Z","closed_at":null,"merged_at":null,"merge_commit_sha":"c42a27300807204381eec4273251b84974b248f5","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/client/pulls/10726/commits","review_comments_url":"https://api.github.com/repos/keybase/client/pulls/10726/comments","review_comment_url":"https://api.github.com/repos/keybase/client/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/client/issues/10726/comments","statuses_url":"https://api.github.com/repos/keybase/client/statuses/4a365bba8092b075cb01315d60277b97abb4b354","head":{"label":"keybase:maxtaco/CORE-7107","ref":"maxtaco/CORE-7107","sha":"4a365bba8092b075cb01315d60277b97abb4b354","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T15:16:50Z","pushed_at":"2018-02-28T21:20:46Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3296,"watchers_count":3296,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1892,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1892,"watchers":3296,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"d55b2546d7ec377a49c9e8230ffd949e7ce9446a","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":29099181,"name":"client","full_name":"keybase/client","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/client","description":"Keybase Go Library, Client, Service, OS X, iOS, Android, Electron","fork":false,"url":"https://api.github.com/repos/keybase/client","forks_url":"https://api.github.com/repos/keybase/client/forks","keys_url":"https://api.github.com/repos/keybase/client/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/client/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/client/teams","hooks_url":"https://api.github.com/repos/keybase/client/hooks","issue_events_url":"https://api.github.com/repos/keybase/client/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/client/events","assignees_url":"https://api.github.com/repos/keybase/client/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/client/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/client/tags","blobs_url":"https://api.github.com/repos/keybase/client/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/client/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/client/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/client/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/client/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/client/languages","stargazers_url":"https://api.github.com/repos/keybase/client/stargazers","contributors_url":"https://api.github.com/repos/keybase/client/contributors","subscribers_url":"https://api.github.com/repos/keybase/client/subscribers","subscription_url":"https://api.github.com/repos/keybase/client/subscription","commits_url":"https://api.github.com/repos/keybase/client/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/client/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/client/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/client/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/client/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/client/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/client/merges","archive_url":"https://api.github.com/repos/keybase/client/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/client/downloads","issues_url":"https://api.github.com/repos/keybase/client/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/client/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/client/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/client/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/client/labels{/name}","releases_url":"https://api.github.com/repos/keybase/client/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/client/deployments","created_at":"2015-01-11T17:17:12Z","updated_at":"2018-02-28T15:16:50Z","pushed_at":"2018-02-28T21:20:46Z","git_url":"git://github.com/keybase/client.git","ssh_url":"git@github.com:keybase/client.git","clone_url":"https://github.com/keybase/client.git","svn_url":"https://github.com/keybase/client","homepage":"","size":223155,"stargazers_count":3296,"watchers_count":3296,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":316,"mirror_url":null,"archived":false,"open_issues_count":1892,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":316,"open_issues":1892,"watchers":3296,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/client/pulls/10726"},"html":{"href":"https://github.com/keybase/client/pull/10726"},"issue":{"href":"https://api.github.com/repos/keybase/client/issues/10726"},"comments":{"href":"https://api.github.com/repos/keybase/client/issues/10726/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/client/pulls/10726/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/client/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/client/pulls/10726/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/client/statuses/4a365bba8092b075cb01315d60277b97abb4b354"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:20:12Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312535284","type":"PushEvent","actor":{"id":516435,"login":"chrisnojima","display_login":"chrisnojima","gravatar_id":"","url":"https://api.github.com/users/chrisnojima","avatar_url":"https://avatars.githubusercontent.com/u/516435?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366675316,"size":2,"distinct_size":2,"ref":"refs/heads/nojima/DESKTOP-chat-clean-11","head":"79f170691b99134697130be20d59fc0ce64596d3","before":"490aefea8abd22b758a249d37d39693ef38ec99a","commits":[{"sha":"e5bbc3dff959a59a5146aaa11b5404cd37675866","author":{"email":"cnojima@keyba.se","name":"chrisnojima"},"message":"WIP","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/e5bbc3dff959a59a5146aaa11b5404cd37675866"},{"sha":"79f170691b99134697130be20d59fc0ce64596d3","author":{"email":"cnojima@keyba.se","name":"chrisnojima"},"message":"WIP","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/79f170691b99134697130be20d59fc0ce64596d3"}]},"public":true,"created_at":"2018-02-28T21:20:26Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312520268","type":"PullRequestReviewCommentEvent","actor":{"id":8516691,"login":"strib","display_login":"strib","gravatar_id":"","url":"https://api.github.com/users/strib","avatar_url":"https://avatars.githubusercontent.com/u/8516691?"},"repo":{"id":59787605,"name":"keybase/kbfs","url":"https://api.github.com/repos/keybase/kbfs"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171387634","pull_request_review_id":100231841,"id":171387634,"diff_hunk":"@@ -0,0 +1,267 @@\n+// Copyright 2018 Keybase Inc. All rights reserved.\n+// Use of this source code is governed by a BSD\n+// license that can be found in the LICENSE file.\n+\n+package main\n+\n+import (\n+\t\"context\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"os/signal\"\n+\t\"os/user\"\n+\t\"path/filepath\"\n+\t\"runtime\"\n+\t\"sort\"\n+\t\"strconv\"\n+\t\"strings\"\n+\t\"sync\"\n+\t\"syscall\"\n+\t\"time\"\n+\n+\t\"bazil.org/fuse\"\n+\t\"bazil.org/fuse/fs\"\n+\t\"github.com/strib/gomounts\"\n+)\n+\n+var kbfusePath = fuse.OSXFUSEPaths{\n+\tDevicePrefix: \"/dev/kbfuse\",\n+\tLoad:         \"/Library/Filesystems/kbfuse.fs/Contents/Resources/load_kbfuse\",\n+\tMount:        \"/Library/Filesystems/kbfuse.fs/Contents/Resources/mount_kbfuse\",\n+\tDaemonVar:    \"MOUNT_KBFUSE_DAEMON_PATH\",\n+}\n+\n+const (\n+\tmountpointTimeout = 5 * time.Second\n+)\n+\n+type symlink struct {\n+\tlink string\n+}\n+\n+func (s symlink) Attr(ctx context.Context, a *fuse.Attr) (err error) {\n+\ta.Mode = os.ModeSymlink | a.Mode | 0555\n+\ta.Valid = 0\n+\treturn nil\n+}\n+\n+func (s symlink) Readlink(ctx context.Context, req *fuse.ReadlinkRequest) (\n+\tlink string, err error) {\n+\treturn s.link, nil\n+}\n+\n+type cacheEntry struct {\n+\tmountpoint string\n+\ttime       time.Time\n+}\n+\n+type root struct {\n+\tlock            sync.RWMutex\n+\tmountpointCache map[uint32]cacheEntry\n+}\n+\n+func newRoot() *root {\n+\treturn &root{\n+\t\tmountpointCache: make(map[uint32]cacheEntry),\n+\t}\n+}\n+\n+func (r *root) Root() (fs.Node, error) {\n+\treturn r, nil\n+}\n+\n+func (r *root) Attr(ctx context.Context, attr *fuse.Attr) error {\n+\tattr.Mode = os.ModeDir | 0555\n+\treturn nil\n+}\n+\n+func (r *root) getCachedMountpoint(uid uint32) string {\n+\tr.lock.RLock()\n+\tdefer r.lock.RUnlock()\n+\tentry, ok := r.mountpointCache[uid]\n+\tif !ok {\n+\t\treturn \"\"\n+\t}\n+\tnow := time.Now()\n+\tif now.Sub(entry.time) > mountpointTimeout {\n+\t\t// Don't bother deleting the entry, since the caller should\n+\t\t// just overwrite it.\n+\t\treturn \"\"\n+\t}\n+\treturn entry.mountpoint\n+}\n+\n+func (r *root) findKBFSMount(ctx context.Context) (\n+\tmountpoint string, err error) {\n+\tuid := ctx.Value(fs.CtxHeaderUIDKey).(uint32)\n+\t// Don't let the root see anything here; we don't want a symlink\n+\t// loop back to this mount.\n+\tif uid == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\n+\tmountpoint = r.getCachedMountpoint(uid)\n+\tif mountpoint != \"\" {\n+\t\treturn mountpoint, nil\n+\t}\n+\n+\tdefer func() {\n+\t\tif err != nil {\n+\t\t\treturn\n+\t\t}\n+\t\t// Cache the entry if we didn't hit an error.\n+\t\tr.lock.Lock()\n+\t\tdefer r.lock.Unlock()\n+\t\tr.mountpointCache[uid] = cacheEntry{\n+\t\t\tmountpoint: mountpoint,\n+\t\t\ttime:       time.Now(),\n+\t\t}\n+\t}()\n+\n+\tu, err := user.LookupId(strconv.FormatUint(uint64(uid), 10))\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\n+\tvols, err := gomounts.GetMountedVolumes()\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\tfuseType := \"fuse\"\n+\tif runtime.GOOS == \"darwin\" {\n+\t\tfuseType = \"kbfuse\"\n+\t}\n+\tvar fuseMountPoints []string\n+\tfor _, v := range vols {\n+\t\tif v.Type != fuseType {\n+\t\t\tcontinue\n+\t\t}\n+\t\tif v.Owner != u.Uid {\n+\t\t\tcontinue\n+\t\t}\n+\t\tfuseMountPoints = append(fuseMountPoints, v.Path)\n+\t}\n+\n+\tif len(fuseMountPoints) == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\tif len(fuseMountPoints) == 1 {\n+\t\treturn fuseMountPoints[0], nil\n+\t}\n+\n+\t// If there is more than one, pick the first one alphabetically\n+\t// that has \"keybase\" in the path.\n+\tsort.Strings(fuseMountPoints)\n+\tfor _, mp := range fuseMountPoints {\n+\t\t// TODO: a better regexp that will rule out keybase.staging if\n+\t\t// we're in prod mode, etc.\n+\t\tif !strings.Contains(mp, \"keybase\") {\n+\t\t\tcontinue\n+\t\t}\n+\t\t// Double-check that this is a real KBFS mount.\n+\t\tif _, err := os.Stat(filepath.Join(mp, \".kbfs_error\")); err != nil {\n+\t\t\tcontinue\n+\t\t}\n+\t\treturn mp, nil\n+\t}\n+\n+\t// Give up and return the first one.\n+\treturn fuseMountPoints[0], nil\n+}\n+\n+func (r *root) ReadDirAll(ctx context.Context) ([]fuse.Dirent, error) {\n+\t_, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\tif err == fuse.ENOENT {\n+\t\t\treturn []fuse.Dirent{}, nil\n+\t\t} else {\n+\t\t\treturn []fuse.Dirent{}, err\n+\t\t}\n+\t}\n+\n+\t// TODO: show the `kbfs.error.txt\" and \"kbfs.nologin.txt\" files if\n+\t// they exist?  As root, it is hard to figure out if they're\n+\t// there, though.\n+\treturn []fuse.Dirent{\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"private\",\n+\t\t},\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"public\",\n+\t\t},\n+\t\tfuse.Dirent{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"team\",\n+\t\t},\n+\t}, nil\n+}\n+\n+func (r *root) Lookup(\n+\tctx context.Context, req *fuse.LookupRequest, resp *fuse.LookupResponse) (\n+\tn fs.Node, err error) {\n+\tmountpoint, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\n+\tresp.EntryValid = 0\n+\tswitch req.Name {\n+\tcase \"private\", \"public\", \"team\", \".kbfs_error\", \".kbfs_metrics\",\n+\t\t\".kbfs_profiles\", \".kbfs_reset_caches\", \".kbfs_status\",\n+\t\t\"kbfs.error.txt\", \"kbfs.nologin.txt\", \".kbfs_enable_auto_journals\",\n+\t\t\".kbfs_disable_auto_journals\", \".kbfs_enable_block_prefetching\",\n+\t\t\".kbfs_disable_block_prefetching\", \".kbfs_enable_debug_server\",\n+\t\t\".kbfs_disable_debug_server\":\n+\t\treturn symlink{filepath.Join(mountpoint, req.Name)}, nil\n+\t}\n+\treturn nil, fuse.ENOENT\n+}\n+\n+func main() {\n+\tcurrUser, err := user.Current()\n+\tif err != nil {\n+\t\tpanic(err)\n+\t}\n+\tif currUser.Uid != \"0\" {\n+\t\truntime.LockOSThread()\n+\t\t_, _, errNo := syscall.Syscall(syscall.SYS_SETUID, 0, 0, 0)","path":"redirector/go/main.go","position":228,"original_position":229,"commit_id":"a375bbaa852f7c4c5475526da029481d313d80e8","original_commit_id":"4a9c54931293f10b5568f92acdec99a7e74547c5","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"@oconnor663: without this call, if you do `./redirector` as a regular user (without using `sudo`), you get an error.  I.e.:\r\n\r\n```sh\r\n$ go build\r\n$ cp go /tmp/redirector\r\n$ cd /tmp/\r\n$ mkdir keybase\r\n$ sudo chown root:root keybase\r\n$ sudo chmod 755 keybase\r\n$ sudo chown root:root redirector\r\n$ sudo chmod 4755 redirector\r\n$ ./redirector /tmp/keybase \r\n2018/02/28 13:15:29 mount helper error: fusermount: user has no write access to mountpoint /tmp/keybase\r\nMount error, exiting cleanly: fusermount: exit status 1\r\n```","created_at":"2018-02-28T21:16:44Z","updated_at":"2018-02-28T21:16:44Z","html_url":"https://github.com/keybase/kbfs/pull/1496#discussion_r171387634","pull_request_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171387634"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496#discussion_r171387634"},"pull_request":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"}},"in_reply_to_id":171385042},"pull_request":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","id":172070599,"html_url":"https://github.com/keybase/kbfs/pull/1496","diff_url":"https://github.com/keybase/kbfs/pull/1496.diff","patch_url":"https://github.com/keybase/kbfs/pull/1496.patch","issue_url":"https://api.github.com/repos/keybase/kbfs/issues/1496","number":1496,"state":"open","locked":false,"title":"redirector: a Go implementation for the root redirector","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"This implementation of the root redirector will likely be used for macOS, at least until we figure out the kbfuse+Rust situation.\r\n\r\nNote that I needed some new bazil.org/fuse options, so I forked it to github.comkeybase/fuse and added two new features:\r\n* A NoBrowse() option that keeps the redirector from showing up in the Finder (instead, the specific user's mount will show up).\r\n* Adding the requesting user's UID to the context for every request, since `ReadDirAll` needs to know whether the requesting user has a valid mountpoint or not.  The bazil.org/fuse interface for `ReadDirAll` doesn't pass this down, so putting it in the context seemed like the easiest option for now.\r\n\r\nIssue: KBFS-2774","created_at":"2018-02-28T20:58:07Z","updated_at":"2018-02-28T21:16:44Z","closed_at":null,"merged_at":null,"merge_commit_sha":"437c5c76f895a2fc4092ddecb665a8ea1424e823","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jzila","id":59594,"avatar_url":"https://avatars1.githubusercontent.com/u/59594?v=4","gravatar_id":"","url":"https://api.github.com/users/jzila","html_url":"https://github.com/jzila","followers_url":"https://api.github.com/users/jzila/followers","following_url":"https://api.github.com/users/jzila/following{/other_user}","gists_url":"https://api.github.com/users/jzila/gists{/gist_id}","starred_url":"https://api.github.com/users/jzila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzila/subscriptions","organizations_url":"https://api.github.com/users/jzila/orgs","repos_url":"https://api.github.com/users/jzila/repos","events_url":"https://api.github.com/users/jzila/events{/privacy}","received_events_url":"https://api.github.com/users/jzila/received_events","type":"User","site_admin":false},{"login":"songgao","id":255797,"avatar_url":"https://avatars3.githubusercontent.com/u/255797?v=4","gravatar_id":"","url":"https://api.github.com/users/songgao","html_url":"https://github.com/songgao","followers_url":"https://api.github.com/users/songgao/followers","following_url":"https://api.github.com/users/songgao/following{/other_user}","gists_url":"https://api.github.com/users/songgao/gists{/gist_id}","starred_url":"https://api.github.com/users/songgao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songgao/subscriptions","organizations_url":"https://api.github.com/users/songgao/orgs","repos_url":"https://api.github.com/users/songgao/repos","events_url":"https://api.github.com/users/songgao/events{/privacy}","received_events_url":"https://api.github.com/users/songgao/received_events","type":"User","site_admin":false},{"login":"akalin-keybase","id":13270622,"avatar_url":"https://avatars3.githubusercontent.com/u/13270622?v=4","gravatar_id":"","url":"https://api.github.com/users/akalin-keybase","html_url":"https://github.com/akalin-keybase","followers_url":"https://api.github.com/users/akalin-keybase/followers","following_url":"https://api.github.com/users/akalin-keybase/following{/other_user}","gists_url":"https://api.github.com/users/akalin-keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/akalin-keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akalin-keybase/subscriptions","organizations_url":"https://api.github.com/users/akalin-keybase/orgs","repos_url":"https://api.github.com/users/akalin-keybase/repos","events_url":"https://api.github.com/users/akalin-keybase/events{/privacy}","received_events_url":"https://api.github.com/users/akalin-keybase/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits","review_comments_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments","review_comment_url":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8","head":{"label":"keybase:strib/KBFS-2774-mount-redirector","ref":"strib/KBFS-2774-mount-redirector","sha":"a375bbaa852f7c4c5475526da029481d313d80e8","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"478a58b55a4605e2abe8699e32adc066bf1df7ee","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496"},"issue":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496"},"comments":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:16:44Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312515191","type":"PushEvent","actor":{"id":11968340,"login":"buoyad","display_login":"buoyad","gravatar_id":"","url":"https://api.github.com/users/buoyad","avatar_url":"https://avatars.githubusercontent.com/u/11968340?"},"repo":{"id":29099181,"name":"keybase/client","url":"https://api.github.com/repos/keybase/client"},"payload":{"push_id":2366664990,"size":1,"distinct_size":1,"ref":"refs/heads/danny/DESKTOP-6135/team-scroll","head":"b41ed064d347f773d5735bf954d0cbffa64310df","before":"fd7e17d840825e8bd0abee56349ad958cf21cdf7","commits":[{"sha":"b41ed064d347f773d5735bf954d0cbffa64310df","author":{"email":"danny.a95@gmail.com","name":"Daniel Ayoub"},"message":"chat button works","distinct":true,"url":"https://api.github.com/repos/keybase/client/commits/b41ed064d347f773d5735bf954d0cbffa64310df"}]},"public":true,"created_at":"2018-02-28T21:15:41Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312512251","type":"IssuesEvent","actor":{"id":252280,"login":"mjallday","display_login":"mjallday","gravatar_id":"","url":"https://api.github.com/users/mjallday","avatar_url":"https://avatars.githubusercontent.com/u/252280?"},"repo":{"id":17025114,"name":"keybase/keybase-issues","url":"https://api.github.com/repos/keybase/keybase-issues"},"payload":{"action":"opened","issue":{"url":"https://api.github.com/repos/keybase/keybase-issues/issues/3195","repository_url":"https://api.github.com/repos/keybase/keybase-issues","labels_url":"https://api.github.com/repos/keybase/keybase-issues/issues/3195/labels{/name}","comments_url":"https://api.github.com/repos/keybase/keybase-issues/issues/3195/comments","events_url":"https://api.github.com/repos/keybase/keybase-issues/issues/3195/events","html_url":"https://github.com/keybase/keybase-issues/issues/3195","id":301185861,"number":3195,"title":"Error: Your public key appears corrupted (no header found)","user":{"login":"mjallday","id":252280,"avatar_url":"https://avatars0.githubusercontent.com/u/252280?v=4","gravatar_id":"","url":"https://api.github.com/users/mjallday","html_url":"https://github.com/mjallday","followers_url":"https://api.github.com/users/mjallday/followers","following_url":"https://api.github.com/users/mjallday/following{/other_user}","gists_url":"https://api.github.com/users/mjallday/gists{/gist_id}","starred_url":"https://api.github.com/users/mjallday/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mjallday/subscriptions","organizations_url":"https://api.github.com/users/mjallday/orgs","repos_url":"https://api.github.com/users/mjallday/repos","events_url":"https://api.github.com/users/mjallday/events{/privacy}","received_events_url":"https://api.github.com/users/mjallday/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2018-02-28T21:15:06Z","updated_at":"2018-02-28T21:15:06Z","closed_at":null,"author_association":"NONE","body":"I'm getting this error when attempting to upload my public GPG key. I previously had the same key on keybase but it was expired.\r\n\r\nThis key appears freshly exported from GPG and looks something like\r\n\r\n```\r\n-----BEGIN PGP PUBLIC KEY BLOCK-----\r\n\r\nmQINBFKmKTkBEADEwkkP4B2KFD5at2PwSsdfVZaASdlmylQ4ZF9AeQzz5dy2woy1\r\n...\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n```\r\n\r\nIf I export the private key it looks something like\r\n\r\n```\r\n-----BEGIN PGP PRIVATE KEY BLOCK-----\r\n\r\nlQdGBFK...\r\n\r\n-----END PGP PRIVATE KEY BLOCK-----\r\n```\r\n\r\nI initially thought this was something similar to #184 but this is a working key that I've been using with GPG since 2013 so I'm pretty sure it's valid. \r\n\r\nYou can find the updated key I'm trying to use on mit key server - `E2804455` http://pgp.mit.edu/pks/lookup?search=E2804455&op=index\r\n\r\nWhen I look at the key it appears to not be expired, am I missing something?\r\n\r\n```\r\n gpg -v < ~/Downloads/Marshall\\ Jones\\ \\(E2804455\\)\\ \\ Public.asc\r\ngpg: WARNING: no command supplied.  Trying to guess what you mean ...\r\npub   rsa4096 2013-12-09 [SC] [expires: 2020-12-10]\r\n      50433C86AAD6968F3D288F98F439FD97E2804455\r\nuid           Marshall Jones <marshall@offby3.com>\r\nsig        F439FD97E2804455 2013-12-09   [selfsig]\r\nsig        F439FD97E2804455 2013-12-09   [selfsig]\r\nsig        F439FD97E2804455 2017-06-22   [selfsig]\r\nuid           Marshall Jones <marshall.jones.1980@gmail.com>\r\nsig        F439FD97E2804455 2013-12-09   [selfsig]\r\nsig        F439FD97E2804455 2017-06-22   [selfsig]\r\nuid           Marshall Jones <marshall@balancedpayments.com>\r\nsig        F439FD97E2804455 2013-12-09   [selfsig]\r\nrev        F439FD97E2804455 2017-06-22   [selfsig]\r\nsig        F439FD97E2804455 2017-06-22   [selfsig]\r\nuid           Marshall Jones <marshall@vgs.io>\r\nsig        F439FD97E2804455 2015-04-30   [selfsig]\r\nsig        F439FD97E2804455 2017-06-22   [selfsig]\r\nuid           Marshall Jones <marshall@verygoodsecurity.com>\r\nsig        F439FD97E2804455 2016-06-07   [selfsig]\r\nsig        F439FD97E2804455 2017-06-22   [selfsig]\r\nsub   rsa4096 2013-12-09 [E] [expires: 2020-12-21]\r\nsig        F439FD97E2804455 2017-12-20   [keybind]\r\n  \r\n```"}},"public":true,"created_at":"2018-02-28T21:15:06Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}},{"id":"7312471313","type":"PullRequestReviewCommentEvent","actor":{"id":860932,"login":"oconnor663","display_login":"oconnor663","gravatar_id":"","url":"https://api.github.com/users/oconnor663","avatar_url":"https://avatars.githubusercontent.com/u/860932?"},"repo":{"id":59787605,"name":"keybase/kbfs","url":"https://api.github.com/repos/keybase/kbfs"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171385042","pull_request_review_id":100228734,"id":171385042,"diff_hunk":"@@ -0,0 +1,267 @@\n+// Copyright 2018 Keybase Inc. All rights reserved.\n+// Use of this source code is governed by a BSD\n+// license that can be found in the LICENSE file.\n+\n+package main\n+\n+import (\n+\t\"context\"\n+\t\"fmt\"\n+\t\"os\"\n+\t\"os/signal\"\n+\t\"os/user\"\n+\t\"path/filepath\"\n+\t\"runtime\"\n+\t\"sort\"\n+\t\"strconv\"\n+\t\"strings\"\n+\t\"sync\"\n+\t\"syscall\"\n+\t\"time\"\n+\n+\t\"bazil.org/fuse\"\n+\t\"bazil.org/fuse/fs\"\n+\t\"github.com/strib/gomounts\"\n+)\n+\n+var kbfusePath = fuse.OSXFUSEPaths{\n+\tDevicePrefix: \"/dev/kbfuse\",\n+\tLoad:         \"/Library/Filesystems/kbfuse.fs/Contents/Resources/load_kbfuse\",\n+\tMount:        \"/Library/Filesystems/kbfuse.fs/Contents/Resources/mount_kbfuse\",\n+\tDaemonVar:    \"MOUNT_KBFUSE_DAEMON_PATH\",\n+}\n+\n+const (\n+\tmountpointTimeout = 5 * time.Second\n+)\n+\n+type symlink struct {\n+\tlink string\n+}\n+\n+func (s symlink) Attr(ctx context.Context, a *fuse.Attr) (err error) {\n+\ta.Mode = os.ModeSymlink | a.Mode | 0555\n+\ta.Valid = 0\n+\treturn nil\n+}\n+\n+func (s symlink) Readlink(ctx context.Context, req *fuse.ReadlinkRequest) (\n+\tlink string, err error) {\n+\treturn s.link, nil\n+}\n+\n+type cacheEntry struct {\n+\tmountpoint string\n+\ttime       time.Time\n+}\n+\n+type root struct {\n+\tlock            sync.RWMutex\n+\tmountpointCache map[uint32]cacheEntry\n+}\n+\n+func newRoot() *root {\n+\treturn &root{\n+\t\tmountpointCache: make(map[uint32]cacheEntry),\n+\t}\n+}\n+\n+func (r *root) Root() (fs.Node, error) {\n+\treturn r, nil\n+}\n+\n+func (r *root) Attr(ctx context.Context, attr *fuse.Attr) error {\n+\tattr.Mode = os.ModeDir | 0555\n+\treturn nil\n+}\n+\n+func (r *root) getCachedMountpoint(uid uint32) string {\n+\tr.lock.RLock()\n+\tdefer r.lock.RUnlock()\n+\tentry, ok := r.mountpointCache[uid]\n+\tif !ok {\n+\t\treturn \"\"\n+\t}\n+\tnow := time.Now()\n+\tif now.Sub(entry.time) > mountpointTimeout {\n+\t\t// Don't bother deleting the entry, since the caller should\n+\t\t// just overwrite it.\n+\t\treturn \"\"\n+\t}\n+\treturn entry.mountpoint\n+}\n+\n+func (r *root) findKBFSMount(ctx context.Context) (\n+\tmountpoint string, err error) {\n+\tuid := ctx.Value(fs.CtxHeaderUIDKey).(uint32)\n+\t// Don't let the root see anything here; we don't want a symlink\n+\t// loop back to this mount.\n+\tif uid == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\n+\tmountpoint = r.getCachedMountpoint(uid)\n+\tif mountpoint != \"\" {\n+\t\treturn mountpoint, nil\n+\t}\n+\n+\tdefer func() {\n+\t\tif err != nil {\n+\t\t\treturn\n+\t\t}\n+\t\t// Cache the entry if we didn't hit an error.\n+\t\tr.lock.Lock()\n+\t\tdefer r.lock.Unlock()\n+\t\tr.mountpointCache[uid] = cacheEntry{\n+\t\t\tmountpoint: mountpoint,\n+\t\t\ttime:       time.Now(),\n+\t\t}\n+\t}()\n+\n+\tu, err := user.LookupId(strconv.FormatUint(uint64(uid), 10))\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\n+\tvols, err := gomounts.GetMountedVolumes()\n+\tif err != nil {\n+\t\treturn \"\", err\n+\t}\n+\tfuseType := \"fuse\"\n+\tif runtime.GOOS == \"darwin\" {\n+\t\tfuseType = \"kbfuse\"\n+\t}\n+\tvar fuseMountPoints []string\n+\tfor _, v := range vols {\n+\t\tif v.Type != fuseType {\n+\t\t\tcontinue\n+\t\t}\n+\t\tif v.Owner != u.Uid {\n+\t\t\tcontinue\n+\t\t}\n+\t\tfuseMountPoints = append(fuseMountPoints, v.Path)\n+\t}\n+\n+\tif len(fuseMountPoints) == 0 {\n+\t\treturn \"\", fuse.ENOENT\n+\t}\n+\tif len(fuseMountPoints) == 1 {\n+\t\treturn fuseMountPoints[0], nil\n+\t}\n+\n+\t// If there is more than one, pick the first one alphabetically\n+\t// that has \"keybase\" in the path.\n+\tsort.Strings(fuseMountPoints)\n+\tfor _, mp := range fuseMountPoints {\n+\t\t// TODO: a better regexp that will rule out keybase.staging if\n+\t\t// we're in prod mode, etc.\n+\t\tif !strings.Contains(mp, \"keybase\") {\n+\t\t\tcontinue\n+\t\t}\n+\t\t// Double-check that this is a real KBFS mount.\n+\t\tif _, err := os.Stat(filepath.Join(mp, \".kbfs_error\")); err != nil {\n+\t\t\tcontinue\n+\t\t}\n+\t\treturn mp, nil\n+\t}\n+\n+\t// Give up and return the first one.\n+\treturn fuseMountPoints[0], nil\n+}\n+\n+func (r *root) ReadDirAll(ctx context.Context) ([]fuse.Dirent, error) {\n+\t_, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\tif err == fuse.ENOENT {\n+\t\t\treturn []fuse.Dirent{}, nil\n+\t\t} else {\n+\t\t\treturn []fuse.Dirent{}, err\n+\t\t}\n+\t}\n+\n+\t// TODO: show the `kbfs.error.txt\" and \"kbfs.nologin.txt\" files if\n+\t// they exist?  As root, it is hard to figure out if they're\n+\t// there, though.\n+\treturn []fuse.Dirent{\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"private\",\n+\t\t},\n+\t\t{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"public\",\n+\t\t},\n+\t\tfuse.Dirent{\n+\t\t\tType: fuse.DT_Link,\n+\t\t\tName: \"team\",\n+\t\t},\n+\t}, nil\n+}\n+\n+func (r *root) Lookup(\n+\tctx context.Context, req *fuse.LookupRequest, resp *fuse.LookupResponse) (\n+\tn fs.Node, err error) {\n+\tmountpoint, err := r.findKBFSMount(ctx)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\n+\tresp.EntryValid = 0\n+\tswitch req.Name {\n+\tcase \"private\", \"public\", \"team\", \".kbfs_error\", \".kbfs_metrics\",\n+\t\t\".kbfs_profiles\", \".kbfs_reset_caches\", \".kbfs_status\",\n+\t\t\"kbfs.error.txt\", \"kbfs.nologin.txt\", \".kbfs_enable_auto_journals\",\n+\t\t\".kbfs_disable_auto_journals\", \".kbfs_enable_block_prefetching\",\n+\t\t\".kbfs_disable_block_prefetching\", \".kbfs_enable_debug_server\",\n+\t\t\".kbfs_disable_debug_server\":\n+\t\treturn symlink{filepath.Join(mountpoint, req.Name)}, nil\n+\t}\n+\treturn nil, fuse.ENOENT\n+}\n+\n+func main() {\n+\tcurrUser, err := user.Current()\n+\tif err != nil {\n+\t\tpanic(err)\n+\t}\n+\tif currUser.Uid != \"0\" {\n+\t\truntime.LockOSThread()\n+\t\t_, _, errNo := syscall.Syscall(syscall.SYS_SETUID, 0, 0, 0)","path":"redirector/go/main.go","position":228,"original_position":229,"commit_id":"a375bbaa852f7c4c5475526da029481d313d80e8","original_commit_id":"4a9c54931293f10b5568f92acdec99a7e74547c5","user":{"login":"oconnor663","id":860932,"avatar_url":"https://avatars0.githubusercontent.com/u/860932?v=4","gravatar_id":"","url":"https://api.github.com/users/oconnor663","html_url":"https://github.com/oconnor663","followers_url":"https://api.github.com/users/oconnor663/followers","following_url":"https://api.github.com/users/oconnor663/following{/other_user}","gists_url":"https://api.github.com/users/oconnor663/gists{/gist_id}","starred_url":"https://api.github.com/users/oconnor663/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oconnor663/subscriptions","organizations_url":"https://api.github.com/users/oconnor663/orgs","repos_url":"https://api.github.com/users/oconnor663/repos","events_url":"https://api.github.com/users/oconnor663/events{/privacy}","received_events_url":"https://api.github.com/users/oconnor663/received_events","type":"User","site_admin":false},"body":"Help me understand what happens if we don't make this call? My Rust redirector doesn't do any SUID step, but if I `chmod 4755` the binary, then I'm able to point it at a regular `0x755 root:root` directory and mount with no problems.","created_at":"2018-02-28T21:06:39Z","updated_at":"2018-02-28T21:06:39Z","html_url":"https://github.com/keybase/kbfs/pull/1496#discussion_r171385042","pull_request_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","author_association":"CONTRIBUTOR","_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments/171385042"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496#discussion_r171385042"},"pull_request":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"}}},"pull_request":{"url":"https://api.github.com/repos/keybase/kbfs/pulls/1496","id":172070599,"html_url":"https://github.com/keybase/kbfs/pull/1496","diff_url":"https://github.com/keybase/kbfs/pull/1496.diff","patch_url":"https://github.com/keybase/kbfs/pull/1496.patch","issue_url":"https://api.github.com/repos/keybase/kbfs/issues/1496","number":1496,"state":"open","locked":false,"title":"redirector: a Go implementation for the root redirector","user":{"login":"strib","id":8516691,"avatar_url":"https://avatars0.githubusercontent.com/u/8516691?v=4","gravatar_id":"","url":"https://api.github.com/users/strib","html_url":"https://github.com/strib","followers_url":"https://api.github.com/users/strib/followers","following_url":"https://api.github.com/users/strib/following{/other_user}","gists_url":"https://api.github.com/users/strib/gists{/gist_id}","starred_url":"https://api.github.com/users/strib/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/strib/subscriptions","organizations_url":"https://api.github.com/users/strib/orgs","repos_url":"https://api.github.com/users/strib/repos","events_url":"https://api.github.com/users/strib/events{/privacy}","received_events_url":"https://api.github.com/users/strib/received_events","type":"User","site_admin":false},"body":"This implementation of the root redirector will likely be used for macOS, at least until we figure out the kbfuse+Rust situation.\r\n\r\nNote that I needed some new bazil.org/fuse options, so I forked it to github.comkeybase/fuse and added two new features:\r\n* A NoBrowse() option that keeps the redirector from showing up in the Finder (instead, the specific user's mount will show up).\r\n* Adding the requesting user's UID to the context for every request, since `ReadDirAll` needs to know whether the requesting user has a valid mountpoint or not.  The bazil.org/fuse interface for `ReadDirAll` doesn't pass this down, so putting it in the context seemed like the easiest option for now.\r\n\r\nIssue: KBFS-2774","created_at":"2018-02-28T20:58:07Z","updated_at":"2018-02-28T21:06:39Z","closed_at":null,"merged_at":null,"merge_commit_sha":"437c5c76f895a2fc4092ddecb665a8ea1424e823","assignee":null,"assignees":[],"requested_reviewers":[{"login":"jzila","id":59594,"avatar_url":"https://avatars1.githubusercontent.com/u/59594?v=4","gravatar_id":"","url":"https://api.github.com/users/jzila","html_url":"https://github.com/jzila","followers_url":"https://api.github.com/users/jzila/followers","following_url":"https://api.github.com/users/jzila/following{/other_user}","gists_url":"https://api.github.com/users/jzila/gists{/gist_id}","starred_url":"https://api.github.com/users/jzila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzila/subscriptions","organizations_url":"https://api.github.com/users/jzila/orgs","repos_url":"https://api.github.com/users/jzila/repos","events_url":"https://api.github.com/users/jzila/events{/privacy}","received_events_url":"https://api.github.com/users/jzila/received_events","type":"User","site_admin":false},{"login":"songgao","id":255797,"avatar_url":"https://avatars3.githubusercontent.com/u/255797?v=4","gravatar_id":"","url":"https://api.github.com/users/songgao","html_url":"https://github.com/songgao","followers_url":"https://api.github.com/users/songgao/followers","following_url":"https://api.github.com/users/songgao/following{/other_user}","gists_url":"https://api.github.com/users/songgao/gists{/gist_id}","starred_url":"https://api.github.com/users/songgao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songgao/subscriptions","organizations_url":"https://api.github.com/users/songgao/orgs","repos_url":"https://api.github.com/users/songgao/repos","events_url":"https://api.github.com/users/songgao/events{/privacy}","received_events_url":"https://api.github.com/users/songgao/received_events","type":"User","site_admin":false},{"login":"akalin-keybase","id":13270622,"avatar_url":"https://avatars3.githubusercontent.com/u/13270622?v=4","gravatar_id":"","url":"https://api.github.com/users/akalin-keybase","html_url":"https://github.com/akalin-keybase","followers_url":"https://api.github.com/users/akalin-keybase/followers","following_url":"https://api.github.com/users/akalin-keybase/following{/other_user}","gists_url":"https://api.github.com/users/akalin-keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/akalin-keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akalin-keybase/subscriptions","organizations_url":"https://api.github.com/users/akalin-keybase/orgs","repos_url":"https://api.github.com/users/akalin-keybase/repos","events_url":"https://api.github.com/users/akalin-keybase/events{/privacy}","received_events_url":"https://api.github.com/users/akalin-keybase/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":null,"commits_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits","review_comments_url":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments","review_comment_url":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}","comments_url":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8","head":{"label":"keybase:strib/KBFS-2774-mount-redirector","ref":"strib/KBFS-2774-mount-redirector","sha":"a375bbaa852f7c4c5475526da029481d313d80e8","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"base":{"label":"keybase:master","ref":"master","sha":"478a58b55a4605e2abe8699e32adc066bf1df7ee","user":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"repo":{"id":59787605,"name":"kbfs","full_name":"keybase/kbfs","owner":{"login":"keybase","id":5400834,"avatar_url":"https://avatars2.githubusercontent.com/u/5400834?v=4","gravatar_id":"","url":"https://api.github.com/users/keybase","html_url":"https://github.com/keybase","followers_url":"https://api.github.com/users/keybase/followers","following_url":"https://api.github.com/users/keybase/following{/other_user}","gists_url":"https://api.github.com/users/keybase/gists{/gist_id}","starred_url":"https://api.github.com/users/keybase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keybase/subscriptions","organizations_url":"https://api.github.com/users/keybase/orgs","repos_url":"https://api.github.com/users/keybase/repos","events_url":"https://api.github.com/users/keybase/events{/privacy}","received_events_url":"https://api.github.com/users/keybase/received_events","type":"Organization","site_admin":false},"private":false,"html_url":"https://github.com/keybase/kbfs","description":"Keybase Filesystem (KBFS)","fork":false,"url":"https://api.github.com/repos/keybase/kbfs","forks_url":"https://api.github.com/repos/keybase/kbfs/forks","keys_url":"https://api.github.com/repos/keybase/kbfs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/keybase/kbfs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/keybase/kbfs/teams","hooks_url":"https://api.github.com/repos/keybase/kbfs/hooks","issue_events_url":"https://api.github.com/repos/keybase/kbfs/issues/events{/number}","events_url":"https://api.github.com/repos/keybase/kbfs/events","assignees_url":"https://api.github.com/repos/keybase/kbfs/assignees{/user}","branches_url":"https://api.github.com/repos/keybase/kbfs/branches{/branch}","tags_url":"https://api.github.com/repos/keybase/kbfs/tags","blobs_url":"https://api.github.com/repos/keybase/kbfs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/keybase/kbfs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/keybase/kbfs/git/refs{/sha}","trees_url":"https://api.github.com/repos/keybase/kbfs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/keybase/kbfs/statuses/{sha}","languages_url":"https://api.github.com/repos/keybase/kbfs/languages","stargazers_url":"https://api.github.com/repos/keybase/kbfs/stargazers","contributors_url":"https://api.github.com/repos/keybase/kbfs/contributors","subscribers_url":"https://api.github.com/repos/keybase/kbfs/subscribers","subscription_url":"https://api.github.com/repos/keybase/kbfs/subscription","commits_url":"https://api.github.com/repos/keybase/kbfs/commits{/sha}","git_commits_url":"https://api.github.com/repos/keybase/kbfs/git/commits{/sha}","comments_url":"https://api.github.com/repos/keybase/kbfs/comments{/number}","issue_comment_url":"https://api.github.com/repos/keybase/kbfs/issues/comments{/number}","contents_url":"https://api.github.com/repos/keybase/kbfs/contents/{+path}","compare_url":"https://api.github.com/repos/keybase/kbfs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/keybase/kbfs/merges","archive_url":"https://api.github.com/repos/keybase/kbfs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/keybase/kbfs/downloads","issues_url":"https://api.github.com/repos/keybase/kbfs/issues{/number}","pulls_url":"https://api.github.com/repos/keybase/kbfs/pulls{/number}","milestones_url":"https://api.github.com/repos/keybase/kbfs/milestones{/number}","notifications_url":"https://api.github.com/repos/keybase/kbfs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/keybase/kbfs/labels{/name}","releases_url":"https://api.github.com/repos/keybase/kbfs/releases{/id}","deployments_url":"https://api.github.com/repos/keybase/kbfs/deployments","created_at":"2016-05-26T22:37:42Z","updated_at":"2018-02-28T02:25:38Z","pushed_at":"2018-02-28T21:03:09Z","git_url":"git://github.com/keybase/kbfs.git","ssh_url":"git@github.com:keybase/kbfs.git","clone_url":"https://github.com/keybase/kbfs.git","svn_url":"https://github.com/keybase/kbfs","homepage":"https://keybase.io/docs/kbfs","size":48520,"stargazers_count":885,"watchers_count":885,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":76,"mirror_url":null,"archived":false,"open_issues_count":46,"license":{"key":"bsd-3-clause","name":"BSD 3-Clause \"New\" or \"Revised\" License","spdx_id":"BSD-3-Clause","url":"https://api.github.com/licenses/bsd-3-clause"},"forks":76,"open_issues":46,"watchers":885,"default_branch":"master"}},"_links":{"self":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496"},"html":{"href":"https://github.com/keybase/kbfs/pull/1496"},"issue":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496"},"comments":{"href":"https://api.github.com/repos/keybase/kbfs/issues/1496/comments"},"review_comments":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/comments"},"review_comment":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/keybase/kbfs/pulls/1496/commits"},"statuses":{"href":"https://api.github.com/repos/keybase/kbfs/statuses/a375bbaa852f7c4c5475526da029481d313d80e8"}},"author_association":"CONTRIBUTOR"}},"public":true,"created_at":"2018-02-28T21:06:39Z","org":{"id":5400834,"login":"keybase","gravatar_id":"","url":"https://api.github.com/orgs/keybase","avatar_url":"https://avatars.githubusercontent.com/u/5400834?"}}]